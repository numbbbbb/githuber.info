function drawChart(a,b,c,d){require(["echarts","echarts/chart/"+c],function(c){var e=c.init(document.getElementById(a));"default"!=d&&d&&require(["echarts/chart/theme/"+d],function(a){e.setTheme(a)}),e.setOption(b)})}function IsRemote(){for(var a=navigator.userAgent,b=new Array("Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"),c=!1,d=0;d<b.length;d++)if(a.indexOf(b[d])>0){c=!0;break}return c}function updateLocalDB(){collection.drop(),collection.insert(window.config)}function utf8_to_b64(a){return window.btoa(unescape(encodeURIComponent(a)))}function b64_to_utf8(a){return decodeURIComponent(escape(window.atob(a)))}require.config({paths:{echarts:"/scripts"}});var App=angular.module("App",["ngRoute"]);App.config(["$locationProvider","$routeProvider",function(a,b){b.when("/index",{controller:"indexCtl",templateUrl:"views/index.html"}).when("/about",{controller:"aboutCtl",templateUrl:"views/about.html"}).when("/donate",{templateUrl:"views/donate.html"}).when("/rank/:target",{controller:"rankCtl",templateUrl:"views/rank.html"}).when("/rank",{controller:"rankCtl",templateUrl:"views/rank.html"}).when("/report",{controller:"reportCtl",templateUrl:"views/report.html"}).when("/search/:targetUser",{controller:"searchCtl",templateUrl:"views/search.html",reloadOnSearch:!1}).otherwise({redirectTo:"/index"}),a.html5Mode(!0)}]),App.factory("anchorScroll",function(){function a(a,c,d){var e=$(window).height();a=$(a),d=d>0?d:e/10,$("html, body").animate({scrollTop:c?a.offset().top-d:a.offset().top+a.outerHeight()+d-e},{duration:200,easing:"linear",complete:function(){b(a)||a[0].scrollIntoView(!!c)}})}function b(a){function b(a){return a>g&&h>a}a=$(a);var c=$(window),d=c.height(),e=a.offset().top,f=a.outerHeight(),g=c.scrollTop(),h=g+d;return b(e+(f>d?d:f)/2)?!0:f>d?b(e+f-d/2):!1}return{toView:a,inView:b}});var clearBDShare=function(){$(".bdshare-slide-button-box").remove(),window._bd_share_is_recently_loaded=!1,window._bd_share_main=null},db=new LocalDB("githuber.info"),collection=db.collection("userInfo");collection.find().then(function(a){a.length?window.config=a[0]:window.config={}}),Object.size=function(a){var b,c=0;for(b in a)a.hasOwnProperty(b)&&c++;return c},$(function(){$(".navbar a").click(function(){$(".navbar-toggle").not(".collapsed").click()});var a=function(){return $(document).trigger("feedback",[$("#feedback-email").val(),$("#feedback-content").val()]),$("#feedback-main").hide(0),$("#feedback-gangnam-style").show(0),setTimeout(function(){$("#feedback-btn").trigger("click"),$("#feedback-gangnam-style").hide(0),$("#feedback-email, #feedback-content").val(""),$("#feedback-main").show(0),setTimeout(function(){$("#feedback-btn").one("click",a)},5e3)},2e3),!1};$("#feedback-btn").one("click",a),$("#feedback-main").click(function(){return!1}),$.digits=function(a){return a.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")};var b=300,c=1200,d=700,e=$(".cd-top");$(window).scroll(function(){$(this).scrollTop()>b?e.addClass("cd-is-visible"):e.removeClass("cd-is-visible cd-fade-out"),$(this).scrollTop()>c&&e.addClass("cd-fade-out")}),e.on("click",function(a){a.preventDefault(),$("body,html").animate({scrollTop:0},d)})}),App.controller("indexCtl",["$scope","$location",function(a,b){function c(a,b){clearTimeout(e);var c;c=[];var d=!1;try{window.btoa(a)}catch(g){d=!0}if(d){for(var h=[],i=/^[A-Za-z][A-Za-z0-9]*$/,j=0;j<a.length;j++)i.test(a[j])?0==h.length?h.push(a[j]):h[h.length-1]=h[h.length-1]+a[j]:h.push(a[j]);h=h.join(" ");var k=function(){$.ajax({url:"https://api.github.com/search/users?q="+h+"+in:fullname",dataType:"json",method:"GET",success:function(a){0!=a.total_count&&($.each(a.items,function(a,b){c.push({value:b.login,src:b.avatar_url})}),b(c))}})};e=setTimeout(k,200),f=k}else{var l=function(){$.ajax({url:"https://api.github.com/search/users?q="+a+"+in:username",dataType:"json",method:"GET",success:function(d){0==d.total_count?$.ajax({url:"https://api.github.com/search/users?q="+a+"+in:fullname",dataType:"json",method:"GET",success:function(a){0!=a.total_count&&($.each(a.items,function(a,b){c.push({value:b.login,src:b.avatar_url})}),b(c))}}):($.each(d.items,function(a,b){c.push({value:b.login,src:b.avatar_url})}),b(c))}})};e=setTimeout(l,300),f=l}}$("#bar-search").hide(0),$(".support-logo").css({transform:"scale("+$(window).height()/1200+")"}),clearBDShare(),$(".support-logo").css({transform:"scale("+$(window).height()/1200+")"}),$.fn.textWidth=function(){var a=$(this).html(),b="<span>"+a+"</span>";$(this).html(b);var c=$(this).find("span:first").width();return $(this).html(a),c},$("#slogan").parent().height($(window).height()/5);var d=$(window).height()-$("#slogan").parent().height()-100-71-$(".report-entry").outerHeight()-parseFloat($(".container-fluid.ng-scope").css("margin-top").replace("px",""))-$(".support-logo").height();$("#search-part").height(parseInt(1*d/5)),$(".report-entry").css("margin-bottom",parseInt(1*d/3)),$("#slogan").css({paddingLeft:$("#our-name").textWidth()-$("#slogan").textWidth()-3+"px"}),a.search=function(){""!=$("#index-input").typeahead("val").replace(/\s/g,"")&&(window.bigcache={},b.path("/search/"+$("#index-input").typeahead("val").replace(/\s/g,"")))};var e,f;$("body").keyup(function(a){32==a.keyCode&&(clearTimeout(e),f())}),$("#index-input").typeahead({hint:!0,highlight:!0,minLength:1},{name:"user",displayKey:"value",source:c,templates:{suggestion:function(a){return"<p><img class='search-avatar' src="+a.src+" alt='头像加载中' />"+a.value+"</p>"}}}),$("html").on("typeahead:selected",function(){$("#lookup").click()}),setTimeout(function(){$("#index-input").trigger("focus")},300)}]),App.controller("reportCtl",["$scope","$location","anchorScroll",function(a,b,c){$("#bar-search").show(0),clearBDShare();var d=function(){$(window).scroll(function(){$(window).scrollTop()+100>=$("#foreword").offset().top?$(".navbar-side").css({position:"fixed",top:"100px"}):$(".navbar-side").css({position:"absolute",top:"50px"})})};a.targetTo=function(a){c.toView(a,!0)};var e={person:{language:{title:{text:"使用语言数统计",subtext:"",x:"center"},tooltip:{trigger:"axis"},calculable:!0,xAxis:[{type:"category",name:"个数",data:["0-5","6-10","11-50","51-100","101-200"]}],yAxis:[{type:"value",name:"人数"}],series:[{name:"语言数",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top"}}},data:[40706,6582,2659,10,2]}]},repoNumber:{title:{text:"仓库数统计",subtext:"",x:"center"},tooltip:{trigger:"axis"},toolbox:{show:!0,feature:{saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:"个数",data:["0-5","6-50","51-200",">=201"]}],yAxis:[{type:"value",name:"人数"}],series:[{name:"人数",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top"}}},data:[27030,21108,1687,134]}]},repoNumber_nofork:{title:{text:"仓库数统计（去除Fork）",subtext:"",x:"center"},tooltip:{trigger:"axis"},toolbox:{show:!0,feature:{saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:"个数",data:["0-5","6-50","51-200"]}],yAxis:[{type:"value",name:"人数"}],series:[{name:"人数",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top"}}},data:[37731,12107,121]}]},code:{title:{text:"代码量统计",subtext:"单位：字节",x:"center"},tooltip:{trigger:"axis"},toolbox:{show:!0,feature:{saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:"字节数",data:["0-1000","1001-1W","1W-10W","10W-100W","100W-1000W",">=1000W"]}],yAxis:[{type:"value",name:"人数"}],series:[{name:"人数",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top"}}},data:[18051,2819,8267,10556,7648,2618]}]},follower:{title:{text:"粉丝数统计",subtext:"",x:"center"},tooltip:{trigger:"axis"},toolbox:{show:!0,feature:{saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:"粉丝数",data:["0-10","11-30","31-1000","1001-5000"]}],yAxis:[{type:"value",name:"人数"}],series:[{name:"人数",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top"}}},data:[56578,2704,1553,23]}]},following:{title:{text:"关注数统计",subtext:"",x:"center"},tooltip:{trigger:"axis"},toolbox:{show:!0,feature:{saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:"个数",data:["0-10","11-30","31-1000","1001-5000",">=5001"]}],yAxis:[{type:"value",name:"人数"}],series:[{name:"人数",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top"}}},data:[53688,4848,2316,4,2]}]},star:{title:{text:"Star数统计",subtext:"",x:"center"},tooltip:{trigger:"axis"},toolbox:{show:!0,feature:{saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:"个数",data:["0-5","6-100","101-500","501-1000","1001-5000","5001-1W"]}],yAxis:[{type:"value",name:"人数"}],series:[{name:"人数",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top"}}},data:[40781,15504,3890,511,169,3]}]}},repo:{star:{title:{text:"Star数统计",subtext:"",x:"center"},tooltip:{trigger:"axis"},toolbox:{show:!0,feature:{saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:"Star数",data:["0-5","6-100","101-500","501-1000","1001-5000","5001-1W"]}],yAxis:[{type:"value",name:"项目数"}],series:[{name:"项目数",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top"}}},data:[215719,8544,801,117,69,5]}]},pullRequest:{title:{text:"PR数统计",subtext:"",x:"center"},tooltip:{trigger:"axis"},toolbox:{show:!0,feature:{saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:"个数",data:["0-5","6-50","51-500",">=501"]}],yAxis:[{type:"value",name:"项目数"}],series:[{name:"项目数",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top"}}},data:[223970,1198,84,3]}]},issue:{title:{text:"Issue数统计",subtext:"",x:"center"},tooltip:{trigger:"axis"},toolbox:{show:!0,feature:{saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:"项目数",data:["0-5","6-50","51-500",">=501"]}],yAxis:[{type:"value",name:"人数"}],series:[{name:"项目数",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top"}}},data:[222602,2399,248,6]}]},code:{title:{text:"代码量统计",subtext:"单位：字节",x:"center"},tooltip:{trigger:"axis"},toolbox:{show:!0,feature:{saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:"字节数",data:["0-1000","1001-10W","1W-10W","10W-100W","100W-1000W",">=1000W"]}],yAxis:[{type:"value",name:"项目数"}],series:[{name:"项目数",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top"}}},data:[70788,44078,64037,31635,12005,2712]}]},branch:{title:{text:"分支数统计",subtext:"",x:"center"},tooltip:{trigger:"axis"},toolbox:{show:!0,feature:{saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:"个数",data:["0-2","3-10",">=11"]}],yAxis:[{type:"value",name:"项目数"}],series:[{name:"项目数",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top"}}},data:[219299,5715,241]}]}},org:{member:{title:{text:"成员数统计",subtext:"",x:"center"},tooltip:{trigger:"axis"},toolbox:{show:!0,feature:{saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:"个数",data:["0-3","4-10","11-50",">=51"]}],yAxis:[{type:"value",name:"人数"}],series:[{name:"组织数",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top"}}},data:[2461,179,48,6]}]},repoNumber_nofork:{title:{text:"仓库数统计（去除Fork）",subtext:"",x:"center"},tooltip:{trigger:"axis"},toolbox:{show:!0,feature:{saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:"个数",data:["0-2","3-10","11-50","51-100"]}],yAxis:[{type:"value",name:"个数"}],series:[{name:"组织数",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top"}}},data:[1141,684,193,19]}]},star:{title:{text:"Star数统计",subtext:"",x:"center"},tooltip:{trigger:"axis"},toolbox:{show:!0,feature:{saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:"个数",data:["0-5","6-100","101-500","501-1000","1001-5000","5001-1W"]}],yAxis:[{type:"value",name:"个数"}],series:[{name:"组织数",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top"}}},data:[8614,1102,173,34,28,1]}]},pullRequest:{title:{text:"PR数统计",subtext:"",x:"center"},tooltip:{trigger:"axis"},toolbox:{show:!0,feature:{saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:"个数",data:["0-5","6-50","51-500",">=501"]}],yAxis:[{type:"value",name:"个数"}],series:[{name:"组织数",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top"}}},data:[9392,458,96,6]}]},issue:{title:{text:"Issue数统计",subtext:"",x:"center"},tooltip:{trigger:"axis"},toolbox:{show:!0,feature:{saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:"个数",data:["0-5","6-50","51-500",">=501"]}],yAxis:[{type:"value",name:"个数"}],series:[{name:"组织数",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top"}}},data:[9255,559,127,11]}]},branch:{title:{text:"分支数统计",subtext:"",x:"center"},tooltip:{trigger:"axis"},toolbox:{show:!0,feature:{saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:"个数",data:["0-2","3-10",">=11"]}],yAxis:[{type:"value",name:"个数"}],series:[{name:"组织数",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top"}}},data:[9163,716,73]}]}}},f={person:{language:{title:{text:"使用语言数对比",subtext:"",x:"center"},tooltip:{trigger:"axis"},legend:{data:["中国","美国"],y:"10%"},toolbox:{show:!0,feature:{saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:"个数",data:["0-5","6-10","11-50","51-100","101-200"]}],yAxis:[{type:"value",name:"百分比"}],series:[{name:"中国",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top",formatter:"{c}%"}}},data:[81.479,13.175,5.322,.02,.004]},{name:"美国",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top",formatter:"{c}%"}}},data:[81.395,14.065,4.523,.015,.002]}]},repoNumber:{title:{text:"仓库数对比",subtext:"",x:"center"},tooltip:{trigger:"axis"},legend:{data:["中国","美国"],y:"10%"},toolbox:{show:!0,feature:{saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:"个数",data:["0-5","6-50","51-200",">=201"]}],yAxis:[{type:"value",name:"百分比"}],series:[{name:"中国",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top",formatter:"{c}%"}}},data:[54.104,42.251,3.377,.268]},{name:"美国",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top",formatter:"{c}%"}}},data:[58.855,38.395,2.645,.105]}]},repoNumber_nofork:{title:{text:"仓库数对比（去除Fork）",subtext:"",x:"center"},tooltip:{trigger:"axis"},legend:{data:["中国","美国"],y:"10%"},toolbox:{show:!0,feature:{saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:"个数",data:["0-5","6-50","51-200"]}],yAxis:[{type:"value",name:"百分比"}],series:[{name:"中国",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top",formatter:"{c}%"}}},data:[75.524,24.234,.242]},{name:"美国",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top",formatter:"{c}%"}}},data:[72.526,26.964,.511]}]},code:{title:{text:"代码量对比",subtext:"",x:"center"},tooltip:{trigger:"axis"},legend:{data:["中国","美国"],y:"10%"},toolbox:{show:!0,feature:{saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:"字节数",data:["0-1000","1001-1W","1W-10W","10W-100W","100W-1000W",">=1000W"]}],yAxis:[{type:"value",name:"百分比"}],series:[{name:"中国",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top",formatter:"{c}%"}}},data:[36.132,5.643,16.548,21.129,15.309,5.24]},{name:"美国",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top",formatter:"{c}%"}}},data:[33.807,6.868,18.75,23.196,13.535,3.844]}]},star:{title:{text:"Star数对比",subtext:"",x:"center"},tooltip:{trigger:"axis"},legend:{data:["中国","美国"],y:"10%"},toolbox:{show:!0,feature:{saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:"个数",data:["0-5","6-100","101-500","501-1000","1001-5000","5001-1W"]}],yAxis:[{type:"value",name:"百分比"}],series:[{name:"中国",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top",formatter:"{c}%"}}},data:[67.01,25.476,6.392,.84,.278,.005]},{name:"美国",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top",formatter:"{c}%"}}},data:[80.091,16.798,2.778,.25,.08,.002,0]}]}},repo:{star:{title:{text:"Star数对比",subtext:"",x:"center"},tooltip:{trigger:"axis"},legend:{data:["中国","美国"],y:"10%"},toolbox:{show:!0,feature:{saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:"Star数",data:["0-5","6-100","101-500","501-1000","1001-5000","5001-1W"]}],yAxis:[{type:"value",name:"百分比"}],series:[{name:"中国",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top",formatter:"{c}%"}}},data:[95.767,3.793,.356,.052,.031,.002]},{name:"美国",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top",formatter:"{c}%"}}},data:[93.881,5.472,.507,.081,.054,.004,.001]}]},pullRequest:{title:{text:"PR数对比",subtext:"",x:"center"},tooltip:{trigger:"axis"},legend:{data:["中国","美国"],y:"10%"},toolbox:{show:!0,feature:{saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:"个数",data:["0-5","6-50","51-500",">=501"]}],yAxis:[{type:"value",name:"百分比"}],series:[{name:"中国",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top",formatter:"{c}%"}}},data:[99.43,.532,.037,.001]},{name:"美国",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top",formatter:"{c}%"}}},data:[98.485,1.4,.112,.003]}]},issue:{title:{text:"Issue数对比",subtext:"",x:"center"},tooltip:{trigger:"axis"},legend:{data:["中国","美国"],y:"10%"},toolbox:{show:!0,feature:{saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:"个数",data:["0-5","6-50","51-500",">=501"]}],yAxis:[{type:"value",name:"百分比"}],series:[{name:"中国",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top",formatter:"{c}%"}}},data:[98.822,1.065,.11,.003]},{name:"美国",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top",formatter:"{c}%"}}},data:[97.365,2.364,.263,.008]}]},code:{title:{text:"代码量对比",subtext:"",x:"center"},tooltip:{trigger:"axis"},legend:{data:["中国","美国"],y:"10%"},toolbox:{show:!0,feature:{saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:"字节数",data:["0-1000","1001-1W","1W-10W","10W-100W","100W-1000W",">=1000W"]}],yAxis:[{type:"value",name:"百分比"}],series:[{name:"中国",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top",formatter:"{c}%"}}},data:[31.426,19.568,28.429,14.044,5.33,1.204]},{name:"美国",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top",formatter:"{c}%"}}},data:[26.144,25.486,32.213,12.073,3.33,.753]}]},branch:{title:{text:"分支数对比",subtext:"",x:"center"},tooltip:{trigger:"axis"},legend:{data:["中国","美国"],y:"10%"},toolbox:{show:!0,feature:{saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:"个数",data:["0-2","3-10",">=11"]}],yAxis:[{type:"value",name:"百分比"}],series:[{name:"中国",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top",formatter:"{c}%"}}},data:[97.356,2.537,.107]},{name:"美国",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top",formatter:"{c}%"}}},data:[95.816,3.909,.275]}]}},org:{member:{title:{text:"成员数对比",subtext:"",x:"center"},tooltip:{trigger:"axis"},legend:{data:["中国","美国"],y:"10%"},toolbox:{show:!0,feature:{saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:"个数",data:["0-3","4-10","11-50",">=51"]}],yAxis:[{type:"value",name:"百分比"}],series:[{name:"中国",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top",formatter:"{c}%"}}},data:[91.351,6.644,1.782,.223]},{name:"美国",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top",formatter:"{c}%"}}},data:[88.958,8.592,2.317,.132]}]},repoNumber_nofork:{title:{text:"仓库数对比（去除Fork）",subtext:"",x:"center"},tooltip:{trigger:"axis"},legend:{data:["中国","美国"],y:"10%"},toolbox:{show:!0,feature:{saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:"个数",data:["0-2","3-10","11-50","51-100"]}],yAxis:[{type:"value",name:"百分比"}],series:[{name:"中国",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top",formatter:"{c}%"}}},data:[56.014,33.579,9.475,.933]},{name:"美国",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top",formatter:"{c}%"}}},data:[53.085,33.118,12.53,1.267]}]},star:{title:{text:"Star数对比",subtext:"",x:"center"},tooltip:{trigger:"axis"},legend:{data:["中国","美国"],y:"10%"},toolbox:{show:!0,feature:{saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:"个数",data:["0-5","6-100","101-500","501-1000","1001-5000","5001-1W"]}],yAxis:[{type:"value",name:"百分比"}],series:[{name:"中国",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top",formatter:"{c}%"}}},data:[86.555,11.073,1.738,.342,.281,.01]},{name:"美国",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top",formatter:"{c}%"}}},data:[85.307,12.571,1.563,.268,.25,.027,.013]}]},pullRequest:{title:{text:"PR数对比",subtext:"",x:"center"},tooltip:{trigger:"axis"},legend:{data:["中国","美国"],y:"10%"},toolbox:{show:!0,feature:{saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:"个数",data:["0-5","6-50","51-500",">=501"]}],yAxis:[{type:"value",name:"百分比"}],series:[{name:"中国",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top",formatter:"{c}%"}}},data:[94.373,4.602,.965,.06]},{name:"美国",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top",formatter:"{c}%"}}},data:[90.833,7.527,1.512,.128]}]},issue:{title:{text:"Issue数对比",subtext:"",x:"center"},tooltip:{trigger:"axis"},legend:{data:["中国","美国"],y:"10%"},toolbox:{show:!0,feature:{saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:"个数",data:["0-5","6-50","51-500",">=501"]}],yAxis:[{type:"value",name:"百分比"}],series:[{name:"中国",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top",formatter:"{c}%"}}},data:[92.996,5.617,1.276,.111]},{name:"美国",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top",formatter:"{c}%"}}},data:[90.289,7.859,1.729,.123]}]},branch:{title:{text:"分支数对比",subtext:"",x:"center"},tooltip:{trigger:"axis"},legend:{data:["中国","美国"],y:"10%"},toolbox:{show:!0,feature:{saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:"个数",data:["0-2","3-10",">=11"]}],yAxis:[{type:"value",name:"百分比"}],series:[{name:"中国",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top",formatter:"{c}%"}}},data:[92.072,7.195,.734]},{name:"美国",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top",formatter:"{c}%"}}},data:[86.944,11.246,1.81]}]},pullRequest:{title:{text:"PR数对比",subtext:"",x:"center"},tooltip:{trigger:"axis"},legend:{data:["中国","美国"],y:"10%"},toolbox:{show:!0,feature:{saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:"个数",data:["0-5","6-50","51-500",">=501"]}],yAxis:[{type:"value",name:"百分比"}],series:[{name:"中国",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top",formatter:"{c}%"}}},data:[99.43,.532,.037,.001]},{name:"美国",type:"bar",itemStyle:{normal:{label:{show:!0,position:"top",formatter:"{c}%"}}},data:[98.485,1.4,.112,.003]}]}}},g=IsRemote();g?(rowWidth=window.innerWidth,$(".navbar-side").css("display","none")):(rowWidth=$("#stat_person_code").width()-1,d());for(var h=[{name:"language",type:"bar"},{name:"code",type:"bar"},{name:"repoNumber",type:"bar"},{name:"repoNumber_nofork",type:"bar"},{name:"follower",type:"bar"},{name:"star",type:"bar"},{name:"following",type:"bar"}],i=[{name:"star",type:"bar"},{name:"pullRequest",type:"bar"},{name:"issue",type:"bar"},{name:"code",type:"bar"},{name:"branch",type:"bar"}],j=[{name:"member",type:"bar"},{name:"repoNumber_nofork",type:"bar"},{name:"star",type:"bar"},{name:"pullRequest",type:"bar"},{name:"issue",type:"bar"},{name:"branch",type:"bar"}],k=[{name:"language",type:"bar"},{name:"repoNumber",type:"bar"},{name:"repoNumber_nofork",type:"bar"},{name:"star",type:"bar"}],l=[{name:"star",type:"bar"},{name:"pullRequest",type:"bar"},{name:"issue",type:"bar"},{name:"code",type:"bar"},{name:"branch",type:"bar"}],m=[{name:"member",type:"bar"},{name:"repoNumber_nofork",type:"bar"},{name:"star",type:"bar"},{name:"pullRequest",type:"bar"},{name:"issue",type:"bar"},{name:"branch",type:"bar"}],n=0,o=h.length;o>n;n++)$("#stat_person_"+h[n].name).width(rowWidth).height(rowWidth/3*2),drawChart("stat_person_"+h[n].name,e.person[h[n].name],h[n].type,"blue"),g&&$("#stat_person_"+h[n].name).css("margin-left","-40px");for(var n=0,o=i.length;o>n;n++)$("#stat_repo_"+i[n].name).width(rowWidth).height(rowWidth/3*2),drawChart("stat_repo_"+i[n].name,e.repo[i[n].name],i[n].type,"default"),g&&$("#stat_repo_"+i[n].name).css("margin-left","-40px");for(var n=0,o=j.length;o>n;n++)$("#stat_org_"+j[n].name).width(rowWidth).height(rowWidth/3*2),drawChart("stat_org_"+j[n].name,e.org[j[n].name],j[n].type,"green"),g&&$("#stat_org_"+j[n].name).css("margin-left","-40px");for(var n=0,o=k.length;o>n;n++)g?($("#comp_person_"+k[n].name).width(rowWidth).height(rowWidth),$("#comp_person_"+k[n].name).css("margin-left","-40px")):$("#comp_person_"+k[n].name).width(3*rowWidth/2).height(rowWidth/2),drawChart("comp_person_"+k[n].name,f.person[k[n].name],k[n].type,"green");for(var n=0,o=l.length;o>n;n++)"code"==l[n].name||"branch"==l[n].name?$("#comp_repo_"+l[n].name).width(rowWidth).height(rowWidth/3*2):g?$("#comp_repo_"+l[n].name).width(rowWidth).height(rowWidth):$("#comp_repo_"+l[n].name).width(3*rowWidth/2).height(rowWidth/2),drawChart("comp_repo_"+l[n].name,f.repo[l[n].name],l[n].type,"default"),g&&$("#comp_repo_"+l[n].name).css("margin-left","-40px");for(var n=0,o=m.length;o>n;n++)"star"==m[n].name||"branch"==m[n].name?(g?$("#comp_org_"+m[n].name).width(rowWidth).height(rowWidth):$("#comp_org_"+m[n].name).width(3*rowWidth/2).height(rowWidth/3*2),drawChart("comp_org_"+m[n].name,f.org[m[n].name],m[n].type,"default")):($("#comp_org_"+m[n].name).width(rowWidth).height(rowWidth/3*2),drawChart("comp_org_"+m[n].name,f.org[m[n].name],m[n].type,"default")),g&&$("#comp_org_"+m[n].name).css("margin-left","-40px")}]),App.controller("searchCtl",["$scope","$routeParams",function($scope,$routeParams){$("#bar-search").show(0),clearBDShare(),$("#new-feature").click(function(){$("#new-feature-modal").modal("show")}),window.forShare=$routeParams.forShare||0,window.forShare&&(window.config.token=$routeParams.token);var smallWindow=$(window).width()<768;smallWindow||$(".spec-info").css("padding","30px"),$("#repo-modal-content").height($(window).height()-$(window).height()/4-60),$(document).trigger("github_id",$routeParams.targetUser),window.config||(window.config={});var debug=!1;if(debug)window.config.token="dc682377021baf45c13f8ea77bd2633d88633512";else{if(window.config&&window.config.token)var token=window.config.token;else{if(!$routeParams.token)return void(window.location.href="https://github.com/login/oauth/authorize?client_id=03fc78670cf59a7a1ca4&state="+$routeParams.targetUser);var token=$routeParams.token;window.config.token=token,updateLocalDB()}$(document).trigger("token",window.config.token)}-1!=window.location.hash.indexOf("token")&&(window.location.hash="/search/"+$routeParams.targetUser),$.ajaxSetup({headers:{Authorization:"token "+window.config.token}}),$scope.targetUser=$routeParams.targetUser,$scope.languageBytesInOwnedRepos={},$scope.languageOfStarredRepos={},$scope.ownedRepoInfos={},$scope.totalBytes=0,$scope.githuber={},$scope.byteChart={},$scope.starChart={},$scope.weekChart={},$scope.dayChart={};var Barrier=function(){this.barrierNumber=0,this.checkFinish=function(a){that=this;var b=function(){0===that.barrierNumber?a():setTimeout(b,200)};setTimeout(b,200)}};window.config&&window.config.email||window.forShare||setTimeout(function(){$("#enter-email").slideDown(function(){$("#inputEmail3").focus()})},2e3),$scope.closeEmail=function(){window.config.email=!0,updateLocalDB(),$("#enter-email").slideUp()},$scope.saveEmail=function(){window.config.email=!0,updateLocalDB(),$("#enter-email").slideUp(),$(document).trigger("emailAddr",$("#inputEmail3").val())},$scope.searchUser=function(){getUserInfo($scope.targetUser)},$scope.generateShareImg=function(){$.ajax({url:"http://api.githuber.info/generateImg?token="+window.config.token+"&width="+$(window).width()+"&username="+$routeParams.targetUser,dataType:"json",method:"GET",success:function(data){with($(".bdshare-slide-button-box").remove(),window._bd_share_is_recently_loaded=!1,window._bd_share_main=null,window._bd_share_config={common:{bdSnsKey:{},bdText:"我在#GitHuber.info#发现牛人一枚，其名曰"+$routeParams.targetUser+"，其详如图，你也来试试吧 @GitHuber_info",bdMini:"1",bdMiniList:["weixin","tsina","qzone","sqq","douban","renren","huaban","youdao","mail","linkedin","copy"],bdPic:data.url,bdStyle:"0",bdSize:"16"},slide:{type:"slide",bdImg:"0",bdPos:"right",bdTop:"150.5"}},document)0[(getElementsByTagName("head")[0]||body).appendChild(createElement("script")).src="http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion="+~(-new Date/36e5)]}})};var getUserInfo=function(a){var b=["login","avatar_url","name","company","email","followers","public_repos","created_at"];if(""!=$scope.targetUser){var c="https://api.github.com/users/"+a;$.ajax({url:c,dataType:"json",method:"GET",success:function(a){window.forShare||$scope.generateShareImg(),getActivityInfo($scope.targetUser),getCodeLines($scope.targetUser),getStarredInfo($scope.targetUser),repoInitial($scope.targetUser);for(var d=0,e=b.length;e>d;d++)$scope.githuber[b[d]]="?"==a[b[d]]?void 0:a[b[d]];$(document).trigger(utf8_to_b64(c),JSON.stringify($scope.githuber)),$scope.githuber.isLoaded=!0,$scope.githuber.isSuccessLoaded=!0,$scope.githuber.followers=$.digits($scope.githuber.followers),$scope.githuber.public_repos=$.digits($scope.githuber.public_repos),$scope.githuber.day=Math.floor(((new Date).getTime()-new Date(a.created_at))/864e5),$scope.$digest()},error:function(a){$scope.githuber.isLoaded=!0,$scope.githuber.isErrorLoaded=!0,$scope.$digest()}},!0)}},getActivityInfo=function(a){$.ajax({url:"http://api.githuber.info/events?login="+a,dataType:"json",method:"GET",success:function(b){if("msg"in b)return $scope.weekChart.isLoaded=!0,$scope.weekChart.isErrorLoaded=!0,$scope.dayChart.isLoaded=!0,$scope.dayChart.isErrorLoaded=!0,void $scope.$digest();var c={},d={},e={},f=[""];$.map(b[a],function(a,b){e[b.replace("Event","")]=a,f.push(b.replace("Event",""))});var g=-Math.round((new Date).getTimezoneOffset()/60);$.each(e,function(a,b){e=b[1],d[a]=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(var f=0;24>f;f++)d[a][f]=e[0>f+g?f+g+24:(f+g)%24];c[a]=b[0];var h=c[a].shift();c[a].push(h)});var h=[];$.map(f,function(a,b){""!=a&&h.push({name:a,type:"bar",stack:"周动态分布",data:c[a]})});var i={title:{text:"周动态分布"},grid:{y:"80"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:f},xAxis:[{type:"category",data:["周一","周二","周三","周四","周五","周六","周日"]}],yAxis:[{type:"value"}],series:h};$scope.weekChart.isLoaded=!0,$scope.weekChart.isSuccessLoaded=!0,$scope.$digest(),drawChart("week-chart",i,"bar"),day_series=[],$.map(f,function(a,b){""!=a&&day_series.push({name:a,type:"bar",stack:"日动态分布",data:d[a]})});var j={title:{text:"日动态分布"},grid:{y:"80"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:f},xAxis:[{type:"category",data:["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"]}],yAxis:[{type:"value"}],series:day_series};$scope.dayChart.isLoaded=!0,$scope.dayChart.isSuccessLoaded=!0,$scope.$digest(),drawChart("day-chart",j,"bar")},error:function(a){$scope.weekChart.isLoaded=!0,$scope.weekChart.isErrorLoaded=!0,$scope.dayChart.isLoaded=!0,$scope.dayChart.isErrorLoaded=!0,$scope.$digest()}})},last="",getCodeLines=function(a){var b=function(c){$.ajax({url:"https://api.github.com/users/"+a+"/repos?page="+c+"&per_page=100",dataType:"json",method:"GET",success:function(d){""==d&&($scope.byteChart.isLoaded=!0,$scope.byteChart.isErrorLoaded=!0,$scope.$digest());var e=new Barrier;e.barrierNumber=d.length,$.map(d,function(b,c){if(b.fork)return void e.barrierNumber--;$scope.ownedRepoInfos[b.id]={description:b.description,name:b.name,stars:b.stargazers_count,url:b.html_url};var d="https://api.github.com/repos/"+a+"/"+b.name+"/languages";$.ajax({url:d,dataType:"json",success:function(a){e.barrierNumber--,b.fork||"status"in a||$.isEmptyObject(a)||($(document).trigger(utf8_to_b64(d),JSON.stringify(a)),$.each(a,function(a,b){isNaN(b)||(a in $scope.languageBytesInOwnedRepos||($scope.languageBytesInOwnedRepos[a]=0),$scope.languageBytesInOwnedRepos[a]+=b)}))},statusCode:{403:function(){e.barrierNumber--}}})}),100===d.length&&(last&&last!==d[0].name||!last)?(last=d[0].name,e.checkFinish(function(){b(c+1)})):e.checkFinish(function(){var a=[];$.each($scope.ownedRepoInfos,function(b,c){c.id=b,a.push(c)}),a.sort(function(a,b){return b.stars-a.stars}),$.map(a,function(a,b){$("#repo-details").append('<div class="row"><div class="col-lg-10 col-lg-offset-1" style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:#E8E8E8;"><h2>'+a.name+' <span class="label label-'+(b>=3?"default":"warning")+'">'+a.stars+' Stars</span></h2><p style="font-size:16px;">'+a.description+'</p><button type="button" class="btn btn-default readme-btn" data-id="'+a.id+'">查看readme</button><a target="_blank" class="btn btn-primary repo-btn" href="'+a.url+'">项目主页</a></div></div>');
}),$(".readme-btn:last").closest("div").css("border-bottom","none");var b=[];$.each($scope.languageBytesInOwnedRepos,function(a,c){b.push({name:a,value:c})}),$("#byte-chart").height(40*b.length+150),b.sort(function(a,b){return a.value-b.value});for(var c=[],d=[],e=0;e<b.length;e++)c.push(b[e].name),smallWindow?d.push(Math.floor(b[e].value/1e3)):d.push(b[e].value);$scope.githuber.codings=d.reduce(function(a,b){return a+b},0),smallWindow&&($scope.githuber.codings=1e3*$scope.githuber.codings),$scope.githuber.codings=$.digits($scope.githuber.codings);var f={title:{text:"代码量统计",subtext:"单位：字节"},tooltip:{trigger:"axis"},xAxis:[{axisLabel:{formatter:function(a){return smallWindow?a+"K":a},rotate:$(window).width()<768?-45:0},type:"value",boundaryGap:[0,0]}],yAxis:[{type:"category",data:c}],series:[{name:"代码量",type:"bar",data:d}]};$scope.byteChart.isLoaded=!0,$scope.byteChart.isSuccessLoaded=!0,$scope.$digest(),drawChart("byte-chart",f,"bar")})}})};b(1)},last="",getStarredInfo=function(a){var b=function(c){var d="https://api.github.com/users/"+a+"/starred?page="+c+"&per_page=100";$.ajax({url:d,dataType:"json",method:"GET",success:function(a){1==c&&""==a&&($scope.starChart.isLoaded=!0,$scope.starChart.isErrorLoaded=!0,$scope.$digest());var e=[];if($.map(a,function(a,b){e.push({language:a.language}),a.language&&(a.language in $scope.languageOfStarredRepos||($scope.languageOfStarredRepos[a.language]=0),$scope.languageOfStarredRepos[a.language]+=1)}),$(document).trigger(utf8_to_b64(d),JSON.stringify(e)),100===a.length&&last&&last!==a[0].name)last=a[0].name,b(c+1);else{var a=[];$.each($scope.languageOfStarredRepos,function(b,c){a.push({name:b,value:c})});var f={title:{text:"star项目语言统计",subtext:"",x:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},series:[{name:"语言",type:"pie",radius:"60%",center:["50%","60%"],data:a}]};$scope.starChart.isLoaded=!0,$scope.starChart.isSuccessLoaded=!0,$scope.$digest(),drawChart("star-chart",f,"pie")}}})};b(1)},repoInitial=function(a){$("#repo-details").on("click",".readme-btn",function(){repo=$scope.ownedRepoInfos[$(this).data("id")],$("#repo-modal-name").html(repo.name),$("#repo-modal-content").html("README内容载入中，请稍候......"),$scope.ownedRepoInfos[repo.id].hasOwnProperty("readme")?$("#repo-modal-content").html($scope.ownedRepoInfos[repo.id].readme):$.ajax({url:"https://api.github.com/repos/"+a+"/"+repo.name+"/readme",dataType:"json",method:"GET",success:function(a){$.ajax({url:"http://api.githuber.info/btoa",method:"POST",dataType:"json",data:{md:a.content},success:function(a){$.ajax({url:"https://api.github.com/markdown",method:"POST",data:JSON.stringify({text:a.result,mode:"markdown"}),success:function(a){$scope.ownedRepoInfos[repo.id].readme=a,$("#repo-modal-content").html(a)}})}})}}),$("#repo-modal").modal("show")})};$scope.searchUser()}]),App.controller("rankCtl",["$scope","$location","$routeParams","anchorScroll","$http",function(a,b,c,d,e){var f=c.target;$("#bar-search").show(0),clearBDShare(),a.data||e.get("http://staticfile00.b0.upaiyun.com/rank.json").success(function(b){a.data=b,a.languages=b.languages,f?a.full_rank=a.languages[f]:a.full_rank=b.full_rank,a.full_rank_data=a.full_rank.data.slice(0,20)}),a.full_rank_switch=!0,a.isDetail=!0,a.switchFullRank=function(b){a.full_rank_switch?a.full_rank_data=a.full_rank.data:(a.full_rank_data=a.full_rank.data.slice(0,20),$("body,html").animate({scrollTop:800},500)),a.full_rank_switch=!a.full_rank_switch},a.getDetail=function(a){b.path("/rank/"+a),$("body,html").animate({scrollTop:0},500)}}]),App.controller("navCtl",["$scope","$location",function(a,b){clearBDShare(),a.search=function(){""!=a.sw.replace(/\s/g,"")&&(window.bigcache={},b.path("/search/"+a.sw))}}]),App.controller("aboutCtl",["$scope","$location",function(a,b){$("#bar-search").show(0),clearBDShare(),a.search=function(){""!=a.sw.replace(/\s/g,"")&&(window.bigcache={},b.path("/search/"+a.sw))},$(".label-info").hover(function(){$(this).css("cursor","pointer")}).click(function(){window.open($(this).data("url"))})}]),!function(a){a.AV=a.AV||{},a.AV.VERSION="js0.4.6"}(this),function(){var a=this,b=a._,c={},d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.push,h=d.slice,i=d.concat,j=e.toString,k=e.hasOwnProperty,l=d.forEach,m=d.map,n=d.reduce,o=d.reduceRight,p=d.filter,q=d.every,r=d.some,s=d.indexOf,t=d.lastIndexOf,u=Array.isArray,v=Object.keys,w=f.bind,x=function(a){return a instanceof x?a:this instanceof x?void(this._wrapped=a):new x(a)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):a._=x,x.VERSION="1.4.4";var y=x.each=x.forEach=function(a,b,d){if(null!=a)if(l&&a.forEach===l)a.forEach(b,d);else if(a.length===+a.length){for(var e=0,f=a.length;f>e;e++)if(b.call(d,a[e],e,a)===c)return}else for(var g in a)if(x.has(a,g)&&b.call(d,a[g],g,a)===c)return};x.map=x.collect=function(a,b,c){var d=[];return null==a?d:m&&a.map===m?a.map(b,c):(y(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)}),d)};var z="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),n&&a.reduce===n)return d&&(b=x.bind(b,d)),e?a.reduce(b,c):a.reduce(b);if(y(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)}),!e)throw new TypeError(z);return c},x.reduceRight=x.foldr=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),o&&a.reduceRight===o)return d&&(b=x.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=a.length;if(f!==+f){var g=x.keys(a);f=g.length}if(y(a,function(h,i,j){i=g?g[--f]:--f,e?c=b.call(d,c,a[i],i,j):(c=a[i],e=!0)}),!e)throw new TypeError(z);return c},x.find=x.detect=function(a,b,c){var d;return A(a,function(a,e,f){return b.call(c,a,e,f)?(d=a,!0):void 0}),d},x.filter=x.select=function(a,b,c){var d=[];return null==a?d:p&&a.filter===p?a.filter(b,c):(y(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)}),d)},x.reject=function(a,b,c){return x.filter(a,function(a,d,e){return!b.call(c,a,d,e)},c)},x.every=x.all=function(a,b,d){b||(b=x.identity);var e=!0;return null==a?e:q&&a.every===q?a.every(b,d):(y(a,function(a,f,g){return(e=e&&b.call(d,a,f,g))?void 0:c}),!!e)};var A=x.some=x.any=function(a,b,d){b||(b=x.identity);var e=!1;return null==a?e:r&&a.some===r?a.some(b,d):(y(a,function(a,f,g){return e||(e=b.call(d,a,f,g))?c:void 0}),!!e)};x.contains=x.include=function(a,b){return null==a?!1:s&&a.indexOf===s?-1!=a.indexOf(b):A(a,function(a){return a===b})},x.invoke=function(a,b){var c=h.call(arguments,2),d=x.isFunction(b);return x.map(a,function(a){return(d?b:a[b]).apply(a,c)})},x.pluck=function(a,b){return x.map(a,function(a){return a[b]})},x.where=function(a,b,c){return x.isEmpty(b)?c?null:[]:x[c?"find":"filter"](a,function(a){for(var c in b)if(b[c]!==a[c])return!1;return!0})},x.findWhere=function(a,b){return x.where(a,b,!0)},x.max=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.max.apply(Math,a);if(!b&&x.isEmpty(a))return-1/0;var d={computed:-1/0,value:-1/0};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>=d.computed&&(d={value:a,computed:g})}),d.value},x.min=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.min.apply(Math,a);if(!b&&x.isEmpty(a))return 1/0;var d={computed:1/0,value:1/0};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})}),d.value},x.shuffle=function(a){var b,c=0,d=[];return y(a,function(a){b=x.random(c++),d[c-1]=d[b],d[b]=a}),d};var B=function(a){return x.isFunction(a)?a:function(b){return b[a]}};x.sortBy=function(a,b,c){var d=B(b);return x.pluck(x.map(a,function(a,b,e){return{value:a,index:b,criteria:d.call(c,a,b,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(d>c||void 0===d)return-1}return a.index<b.index?-1:1}),"value")};var C=function(a,b,c,d){var e={},f=B(b||x.identity);return y(a,function(b,g){var h=f.call(c,b,g,a);d(e,h,b)}),e};x.groupBy=function(a,b,c){return C(a,b,c,function(a,b,c){(x.has(a,b)?a[b]:a[b]=[]).push(c)})},x.countBy=function(a,b,c){return C(a,b,c,function(a,b){x.has(a,b)||(a[b]=0),a[b]++})},x.sortedIndex=function(a,b,c,d){c=null==c?x.identity:B(c);for(var e=c.call(d,b),f=0,g=a.length;g>f;){var h=f+g>>>1;c.call(d,a[h])<e?f=h+1:g=h}return f},x.toArray=function(a){return a?x.isArray(a)?h.call(a):a.length===+a.length?x.map(a,x.identity):x.values(a):[]},x.size=function(a){return null==a?0:a.length===+a.length?a.length:x.keys(a).length},x.first=x.head=x.take=function(a,b,c){return null==a?void 0:null==b||c?a[0]:h.call(a,0,b)},x.initial=function(a,b,c){return h.call(a,0,a.length-(null==b||c?1:b))},x.last=function(a,b,c){return null==a?void 0:null==b||c?a[a.length-1]:h.call(a,Math.max(a.length-b,0))},x.rest=x.tail=x.drop=function(a,b,c){return h.call(a,null==b||c?1:b)},x.compact=function(a){return x.filter(a,x.identity)};var D=function(a,b,c){return y(a,function(a){x.isArray(a)?b?g.apply(c,a):D(a,b,c):c.push(a)}),c};x.flatten=function(a,b){return D(a,b,[])},x.without=function(a){return x.difference(a,h.call(arguments,1))},x.uniq=x.unique=function(a,b,c,d){x.isFunction(b)&&(d=c,c=b,b=!1);var e=c?x.map(a,c,d):a,f=[],g=[];return y(e,function(c,d){(b?d&&g[g.length-1]===c:x.contains(g,c))||(g.push(c),f.push(a[d]))}),f},x.union=function(){return x.uniq(i.apply(d,arguments))},x.intersection=function(a){var b=h.call(arguments,1);return x.filter(x.uniq(a),function(a){return x.every(b,function(b){return x.indexOf(b,a)>=0})})},x.difference=function(a){var b=i.apply(d,h.call(arguments,1));return x.filter(a,function(a){return!x.contains(b,a)})},x.zip=function(){for(var a=h.call(arguments),b=x.max(x.pluck(a,"length")),c=new Array(b),d=0;b>d;d++)c[d]=x.pluck(a,""+d);return c},x.object=function(a,b){if(null==a)return{};for(var c={},d=0,e=a.length;e>d;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c},x.indexOf=function(a,b,c){if(null==a)return-1;var d=0,e=a.length;if(c){if("number"!=typeof c)return d=x.sortedIndex(a,b),a[d]===b?d:-1;d=0>c?Math.max(0,e+c):c}if(s&&a.indexOf===s)return a.indexOf(b,c);for(;e>d;d++)if(a[d]===b)return d;return-1},x.lastIndexOf=function(a,b,c){if(null==a)return-1;var d=null!=c;if(t&&a.lastIndexOf===t)return d?a.lastIndexOf(b,c):a.lastIndexOf(b);for(var e=d?c:a.length;e--;)if(a[e]===b)return e;return-1},x.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);d>e;)f[e++]=a,a+=c;return f},x.bind=function(a,b){if(a.bind===w&&w)return w.apply(a,h.call(arguments,1));var c=h.call(arguments,2);return function(){return a.apply(b,c.concat(h.call(arguments)))}},x.partial=function(a){var b=h.call(arguments,1);return function(){return a.apply(this,b.concat(h.call(arguments)))}},x.bindAll=function(a){var b=h.call(arguments,1);return 0===b.length&&(b=x.functions(a)),y(b,function(b){a[b]=x.bind(a[b],a)}),a},x.memoize=function(a,b){var c={};return b||(b=x.identity),function(){var d=b.apply(this,arguments);return x.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},x.delay=function(a,b){var c=h.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},x.defer=function(a){return x.delay.apply(x,[a,1].concat(h.call(arguments,1)))},x.throttle=function(a,b){var c,d,e,f,g=0,h=function(){g=new Date,e=null,f=a.apply(c,d)};return function(){var i=new Date,j=b-(i-g);return c=this,d=arguments,0>=j?(clearTimeout(e),e=null,g=i,f=a.apply(c,d)):e||(e=setTimeout(h,j)),f}},x.debounce=function(a,b,c){var d,e;return function(){var f=this,g=arguments,h=function(){d=null,c||(e=a.apply(f,g))},i=c&&!d;return clearTimeout(d),d=setTimeout(h,b),i&&(e=a.apply(f,g)),e}},x.once=function(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments),a=null,b)}},x.wrap=function(a,b){return function(){var c=[a];return g.apply(c,arguments),b.apply(this,c)}},x.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},x.after=function(a,b){return 0>=a?b():function(){return--a<1?b.apply(this,arguments):void 0}},x.keys=v||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)x.has(a,c)&&(b[b.length]=c);return b},x.values=function(a){var b=[];for(var c in a)x.has(a,c)&&b.push(a[c]);return b},x.pairs=function(a){var b=[];for(var c in a)x.has(a,c)&&b.push([c,a[c]]);return b},x.invert=function(a){var b={};for(var c in a)x.has(a,c)&&(b[a[c]]=c);return b},x.functions=x.methods=function(a){var b=[];for(var c in a)x.isFunction(a[c])&&b.push(c);return b.sort()},x.extend=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]}),a},x.pick=function(a){var b={},c=i.apply(d,h.call(arguments,1));return y(c,function(c){c in a&&(b[c]=a[c])}),b},x.omit=function(a){var b={},c=i.apply(d,h.call(arguments,1));for(var e in a)x.contains(c,e)||(b[e]=a[e]);return b},x.defaults=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)null==a[c]&&(a[c]=b[c])}),a},x.clone=function(a){return x.isObject(a)?x.isArray(a)?a.slice():x.extend({},a):a},x.tap=function(a,b){return b(a),a};var E=function(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof x&&(a=a._wrapped),b instanceof x&&(b=b._wrapped);var e=j.call(a);if(e!=j.call(b))return!1;switch(e){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=c.length;f--;)if(c[f]==a)return d[f]==b;c.push(a),d.push(b);var g=0,h=!0;if("[object Array]"==e){if(g=a.length,h=g==b.length)for(;g--&&(h=E(a[g],b[g],c,d)););}else{var i=a.constructor,k=b.constructor;if(i!==k&&!(x.isFunction(i)&&i instanceof i&&x.isFunction(k)&&k instanceof k))return!1;for(var l in a)if(x.has(a,l)&&(g++,!(h=x.has(b,l)&&E(a[l],b[l],c,d))))break;if(h){for(l in b)if(x.has(b,l)&&!g--)break;h=!g}}return c.pop(),d.pop(),h};x.isEqual=function(a,b){return E(a,b,[],[])},x.isEmpty=function(a){if(null==a)return!0;if(x.isArray(a)||x.isString(a))return 0===a.length;for(var b in a)if(x.has(a,b))return!1;return!0},x.isElement=function(a){return!(!a||1!==a.nodeType)},x.isArray=u||function(a){return"[object Array]"==j.call(a)},x.isObject=function(a){return a===Object(a)},y(["Arguments","Function","String","Number","Date","RegExp"],function(a){x["is"+a]=function(b){return j.call(b)=="[object "+a+"]"}}),x.isArguments(arguments)||(x.isArguments=function(a){return!(!a||!x.has(a,"callee"))}),"function"!=typeof/./&&(x.isFunction=function(a){return"function"==typeof a}),x.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},x.isNaN=function(a){return x.isNumber(a)&&a!=+a},x.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"==j.call(a)},x.isNull=function(a){return null===a},x.isUndefined=function(a){return void 0===a},x.has=function(a,b){return k.call(a,b)},x.noConflict=function(){return a._=b,this},x.identity=function(a){return a},x.times=function(a,b,c){for(var d=Array(a),e=0;a>e;e++)d[e]=b.call(c,e);return d},x.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))};var F={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};F.unescape=x.invert(F.escape);var G={escape:new RegExp("["+x.keys(F.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(F.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(a){x[a]=function(b){return null==b?"":(""+b).replace(G[a],function(b){return F[a][b]})}}),x.result=function(a,b){if(null==a)return null;var c=a[b];return x.isFunction(c)?c.call(a):c},x.mixin=function(a){y(x.functions(a),function(b){var c=x[b]=a[b];x.prototype[b]=function(){var a=[this._wrapped];return g.apply(a,arguments),L.call(this,c.apply(x,a))}})};var H=0;x.uniqueId=function(a){var b=++H+"";return a?a+b:b},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var I=/(.)^/,J={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},K=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(a,b,c){var d;c=x.defaults({},c,x.templateSettings);var e=new RegExp([(c.escape||I).source,(c.interpolate||I).source,(c.evaluate||I).source].join("|")+"|$","g"),f=0,g="__p+='";a.replace(e,function(b,c,d,e,h){return g+=a.slice(f,h).replace(K,function(a){return"\\"+J[a]}),c&&(g+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'"),d&&(g+="'+\n((__t=("+d+"))==null?'':__t)+\n'"),e&&(g+="';\n"+e+"\n__p+='"),f=h+b.length,b}),g+="';\n",c.variable||(g="with(obj||{}){\n"+g+"}\n"),g="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+g+"return __p;\n";try{d=new Function(c.variable||"obj","_",g)}catch(h){throw h.source=g,h}if(b)return d(b,x);var i=function(a){return d.call(this,a,x)};return i.source="function("+(c.variable||"obj")+"){\n"+g+"}",i},x.chain=function(a){return x(a).chain()};var L=function(a){return this._chain?x(a).chain():a};x.mixin(x),y(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];x.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!=a&&"splice"!=a||0!==c.length||delete c[0],L.call(this,c)}}),y(["concat","join","slice"],function(a){var b=d[a];x.prototype[a]=function(){return L.call(this,b.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),function(a){a.AV=a.AV||{};var b=a.AV;if("undefined"!=typeof exports&&exports._){b._=exports._.noConflict();try{b.localStorage=require("localStorage")}catch(c){b.localStorage=require("./localStorage.js").localStorage}b.XMLHttpRequest=require("xmlhttprequest").XMLHttpRequest,exports.AV=b}else b._=_.noConflict(),"undefined"!=typeof localStorage&&(b.localStorage=localStorage),"undefined"!=typeof XMLHttpRequest&&(b.XMLHttpRequest=XMLHttpRequest);"undefined"!=typeof $&&(b.$=$);var d=function(){},e=function(a,c,e){var f;return f=c&&c.hasOwnProperty("constructor")?c.constructor:function(){a.apply(this,arguments)},b._.extend(f,a),d.prototype=a.prototype,f.prototype=new d,c&&b._.extend(f.prototype,c),e&&b._.extend(f,e),f.prototype.constructor=f,f.__super__=a.prototype,f};b.serverURL="https://cn.avoscloud.com","undefined"!=typeof process&&process.versions&&process.versions.node&&(b._isNode=!0),b.initialize=function(a,c,d){if(d)throw"AV.initialize() was passed a Master Key, which is only allowed from within Node.js.";b._initialize(a,c,d)},b._initialize=function(a,c,d){b.applicationId=a,b.applicationKey=c,b.masterKey=d,b._useMasterKey=!1},b.setProduction=function(a){b._isNullOrUndefined(a)||(a=a?1:0),b.applicationProduction=b._isNullOrUndefined(a)?1:a},b._isNode&&(b.initialize=b._initialize,b.Cloud=b.Cloud||{},b.Cloud.useMasterKey=function(){b._useMasterKey=!0}),b.useAVCloudCN=function(){b.serverURL="https://cn.avoscloud.com"},b.useAVCloudUS=function(){b.serverURL="https://us.avoscloud.com"},b._getAVPath=function(a){if(!b.applicationId)throw"You need to call AV.initialize before using AV.";if(a||(a=""),!b._.isString(a))throw"Tried to get a localStorage path that wasn't a String.";return"/"===a[0]&&(a=a.substring(1)),"AV/"+b.applicationId+"/"+a},b._installationId=null,b._getInstallationId=function(){if(b._installationId)return b._installationId;var a=b._getAVPath("installationId");if(b._installationId=b.localStorage.getItem(a),!b._installationId||""===b._installationId){var c=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};b._installationId=c()+c()+"-"+c()+"-"+c()+"-"+c()+"-"+c()+c()+c(),b.localStorage.setItem(a,b._installationId)}return b._installationId},b._parseDate=function(a){var b=new RegExp("^([0-9]{1,4})-([0-9]{1,2})-([0-9]{1,2})T([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2})(.([0-9]+))?Z$"),c=b.exec(a);if(!c)return null;var d=c[1]||0,e=(c[2]||1)-1,f=c[3]||0,g=c[4]||0,h=c[5]||0,i=c[6]||0,j=c[8]||0;return new Date(Date.UTC(d,e,f,g,h,i,j))},b._ajaxIE8=function(a,c,d){var e=new b.Promise,f=new XDomainRequest;return f.onload=function(){var a;try{a=JSON.parse(f.responseText)}catch(b){e.reject(b)}a&&e.resolve(a)},f.onerror=f.ontimeout=function(){e.reject(f)},f.onprogress=function(){},f.open(a,c),f.send(d),e},b._ajax=function(a,c,d,e,f){var g={success:e,error:f};if("undefined"!=typeof XDomainRequest)return b._ajaxIE8(a,c,d)._thenRunCallbacks(g);var h=new b.Promise,i=!1,j=new b.XMLHttpRequest;return j.onreadystatechange=function(){if(4===j.readyState){if(i)return;if(i=!0,j.status>=200&&j.status<300){var a;try{a=JSON.parse(j.responseText)}catch(b){h.reject(b)}a&&h.resolve(a,j.status,j)}else h.reject(j)}},j.open(a,c,!0),j.setRequestHeader("Content-Type","text/plain"),b._isNode&&j.setRequestHeader("User-Agent","AV/"+b.VERSION+" (NodeJS "+process.versions.node+")"),j.send(d),h._thenRunCallbacks(g)},b._extend=function(a,b){var c=e(this,a,b);return c.extend=this.extend,c},b._request=function(a,c,d,e,f){if(!b.applicationId)throw"You must specify your applicationId using AV.initialize";if(!b.applicationKey&&!b.masterKey)throw"You must specify a key using AV.initialize";if("batch"!==a&&"classes"!==a&&"files"!==a&&"functions"!==a&&"login"!==a&&"push"!==a&&"search/select"!==a&&"requestPasswordReset"!==a&&"requestEmailVerify"!==a&&"requestPasswordResetBySmsCode"!==a&&"resetPasswordBySmsCode"!==a&&"requestMobilePhoneVerify"!==a&&"requestLoginSmsCode"!==a&&"verifyMobilePhone"!==a&&"requestSmsCode"!==a&&"verifySmsCode"!==a&&"users"!==a&&"cloudQuery"!==a&&"qiniu"!==a&&"statuses"!==a&&"subscribe/statuses/count"!==a&&"subscribe/statuses"!==a&&!/users\/[^\/]+\/friendship\/[^\/]+/.test(a))throw"Bad route: '"+a+"'.";var g=b.serverURL;"/"!==g.charAt(g.length-1)&&(g+="/"),g+="1.1/"+a,c&&(g+="/"+c),d&&(g+="/"+d),"users"!==a&&"classes"!==a||"PUT"!==e||!f._fetchWhenSave||(delete f._fetchWhenSave,g+="?new=true"),f=b._.clone(f||{}),"POST"!==e&&(f._method=e,e="POST"),f._ApplicationId=b.applicationId,f._ApplicationKey=b.applicationKey,b._isNullOrUndefined(b.applicationProduction)||(f._ApplicationProduction=b.applicationProduction),b._useMasterKey&&(f._MasterKey=b.masterKey),f._ClientVersion=b.VERSION,f._InstallationId=b._getInstallationId();var h=b.User.current();h&&h._sessionToken&&(f._SessionToken=h._sessionToken);var i=JSON.stringify(f);return b._ajax(e,g,i).then(null,function(a){var c;if(a&&a.responseText)try{var d=JSON.parse(a.responseText);d&&(c=new b.Error(d.code,d.error))}catch(e){}return c=c||new b.Error(-1,a.responseText),b.Promise.error(c)})},b._getValue=function(a,c){return a&&a[c]?b._.isFunction(a[c])?a[c]():a[c]:null},b._encode=function(a,c,d){var e=b._;if(a instanceof b.Object){if(d)throw"AV.Objects not allowed here";if(!c||e.include(c,a)||!a._hasData)return a._toPointer();if(!a.dirty())return c=c.concat(a),b._encode(a._toFullJSON(c),c,d);throw"Tried to save an object with a pointer to a new, unsaved object."}if(a instanceof b.ACL)return a.toJSON();if(e.isDate(a))return{__type:"Date",iso:a.toJSON()};if(a instanceof b.GeoPoint)return a.toJSON();if(e.isArray(a))return e.map(a,function(a){return b._encode(a,c,d)});if(e.isRegExp(a))return a.source;if(a instanceof b.Relation)return a.toJSON();if(a instanceof b.Op)return a.toJSON();if(a instanceof b.File){if(!a.url()&&!a.id)throw"Tried to save an object containing an unsaved file.";return{__type:"File",id:a.id,name:a.name(),url:a.url()}}if(e.isObject(a)){var f={};return b._objectEach(a,function(a,e){f[e]=b._encode(a,c,d)}),f}return a},b._decode=function(a,c){var d=b._;if(!d.isObject(c))return c;if(d.isArray(c))return b._arrayEach(c,function(a,d){c[d]=b._decode(d,a)}),c;if(c instanceof b.Object)return c;if(c instanceof b.File)return c;if(c instanceof b.Op)return c;if(c.__op)return b.Op._decode(c);if("Pointer"===c.__type){var e=c.className,f=b.Object._create(e);return c.createdAt?(delete c.__type,delete c.className,f._finishFetch(c,!0)):f._finishFetch({objectId:c.objectId},!1),f}if("Object"===c.__type){var e=c.className;delete c.__type,delete c.className;var g=b.Object._create(e);return g._finishFetch(c,!0),g}if("Date"===c.__type)return b._parseDate(c.iso);if("GeoPoint"===c.__type)return new b.GeoPoint({latitude:c.latitude,longitude:c.longitude});if("ACL"===a)return c instanceof b.ACL?c:new b.ACL(c);if("Relation"===c.__type){var h=new b.Relation(null,a);return h.targetClassName=c.className,h}if("File"===c.__type){var i=new b.File(c.name);return i._metaData=c.metaData||{},i._url=c.url,i.id=c.objectId,i}return b._objectEach(c,function(a,d){c[d]=b._decode(d,a)}),c},b._arrayEach=b._.each,b._traverse=function(a,c,d){if(a instanceof b.Object){if(d=d||[],b._.indexOf(d,a)>=0)return;return d.push(a),b._traverse(a.attributes,c,d),c(a)}return a instanceof b.Relation||a instanceof b.File?c(a):b._.isArray(a)?(b._.each(a,function(e,f){var g=b._traverse(e,c,d);g&&(a[f]=g)}),c(a)):b._.isObject(a)?(b._each(a,function(e,f){var g=b._traverse(e,c,d);g&&(a[f]=g)}),c(a)):c(a)},b._objectEach=b._each=function(a,c){var d=b._;d.isObject(a)?d.each(d.keys(a),function(b){c(a[b],b)}):d.each(a,c)},b._isNullOrUndefined=function(a){return b._.isNull(a)||b._.isUndefined(a)}}(this),function(a){a.AV=a.AV||{};var b=a.AV,c=b._;b.Error=function(a,b){this.code=a,this.message=b},c.extend(b.Error,{OTHER_CAUSE:-1,INTERNAL_SERVER_ERROR:1,CONNECTION_FAILED:100,OBJECT_NOT_FOUND:101,INVALID_QUERY:102,INVALID_CLASS_NAME:103,MISSING_OBJECT_ID:104,INVALID_KEY_NAME:105,INVALID_POINTER:106,INVALID_JSON:107,COMMAND_UNAVAILABLE:108,NOT_INITIALIZED:109,INCORRECT_TYPE:111,INVALID_CHANNEL_NAME:112,PUSH_MISCONFIGURED:115,OBJECT_TOO_LARGE:116,OPERATION_FORBIDDEN:119,CACHE_MISS:120,INVALID_NESTED_KEY:121,INVALID_FILE_NAME:122,INVALID_ACL:123,TIMEOUT:124,INVALID_EMAIL_ADDRESS:125,MISSING_CONTENT_TYPE:126,MISSING_CONTENT_LENGTH:127,INVALID_CONTENT_LENGTH:128,FILE_TOO_LARGE:129,FILE_SAVE_ERROR:130,FILE_DELETE_ERROR:153,DUPLICATE_VALUE:137,INVALID_ROLE_NAME:139,EXCEEDED_QUOTA:140,SCRIPT_FAILED:141,VALIDATION_ERROR:142,INVALID_IMAGE_DATA:150,UNSAVED_FILE_ERROR:151,INVALID_PUSH_TIME_ERROR:152,USERNAME_MISSING:200,PASSWORD_MISSING:201,USERNAME_TAKEN:202,EMAIL_TAKEN:203,EMAIL_MISSING:204,EMAIL_NOT_FOUND:205,SESSION_MISSING:206,MUST_CREATE_USER_THROUGH_SIGNUP:207,ACCOUNT_ALREADY_LINKED:208,LINKED_ID_MISSING:250,INVALID_LINKED_SESSION:251,UNSUPPORTED_SERVICE:252})}(this),function(){var a=this,b=a.AV||(a.AV={}),c=/\s+/,d=Array.prototype.slice;b.Events={on:function(a,b,d){var e,f,g,h,i;if(!b)return this;for(a=a.split(c),e=this._callbacks||(this._callbacks={}),f=a.shift();f;)i=e[f],g=i?i.tail:{},g.next=h={},g.context=d,g.callback=b,e[f]={tail:h,next:i?i.next:g},f=a.shift();return this},off:function(a,b,d){var e,f,g,h,i,j;if(f=this._callbacks){if(!(a||b||d))return delete this._callbacks,this;for(a=a?a.split(c):_.keys(f),e=a.shift();e;)if(g=f[e],delete f[e],g&&(b||d)){for(h=g.tail,g=g.next;g!==h;)i=g.callback,j=g.context,(b&&i!==b||d&&j!==d)&&this.on(e,i,j),g=g.next;e=a.shift()}return this}},trigger:function(a){var b,e,f,g,h,i,j;if(!(f=this._callbacks))return this;for(i=f.all,a=a.split(c),j=d.call(arguments,1),b=a.shift();b;){if(e=f[b])for(g=e.tail;(e=e.next)!==g;)e.callback.apply(e.context||this,j);if(e=i)for(g=e.tail,h=[b].concat(j);(e=e.next)!==g;)e.callback.apply(e.context||this,h);b=a.shift()}return this}},b.Events.bind=b.Events.on,b.Events.unbind=b.Events.off}.call(this),function(a){a.AV=a.AV||{};var b=a.AV,c=b._;b.GeoPoint=function(a,d){c.isArray(a)?(b.GeoPoint._validate(a[0],a[1]),this.latitude=a[0],this.longitude=a[1]):c.isObject(a)?(b.GeoPoint._validate(a.latitude,a.longitude),this.latitude=a.latitude,this.longitude=a.longitude):c.isNumber(a)&&c.isNumber(d)?(b.GeoPoint._validate(a,d),this.latitude=a,this.longitude=d):(this.latitude=0,this.longitude=0);var e=this;this.__defineGetter__&&this.__defineSetter__&&(this._latitude=this.latitude,this._longitude=this.longitude,this.__defineGetter__("latitude",function(){return e._latitude}),this.__defineGetter__("longitude",function(){return e._longitude}),this.__defineSetter__("latitude",function(a){b.GeoPoint._validate(a,e.longitude),e._latitude=a}),this.__defineSetter__("longitude",function(a){b.GeoPoint._validate(e.latitude,a),e._longitude=a}))},b.GeoPoint._validate=function(a,b){if(-90>a)throw"AV.GeoPoint latitude "+a+" < -90.0.";if(a>90)throw"AV.GeoPoint latitude "+a+" > 90.0.";if(-180>b)throw"AV.GeoPoint longitude "+b+" < -180.0.";if(b>180)throw"AV.GeoPoint longitude "+b+" > 180.0."},b.GeoPoint.current=function(a){var c=new b.Promise;return navigator.geolocation.getCurrentPosition(function(a){c.resolve(new b.GeoPoint({latitude:a.coords.latitude,longitude:a.coords.longitude}))},function(a){c.reject(a)}),c._thenRunCallbacks(a)},b.GeoPoint.prototype={toJSON:function(){return b.GeoPoint._validate(this.latitude,this.longitude),{__type:"GeoPoint",latitude:this.latitude,longitude:this.longitude}},radiansTo:function(a){var b=Math.PI/180,c=this.latitude*b,d=this.longitude*b,e=a.latitude*b,f=a.longitude*b,g=c-e,h=d-f,i=Math.sin(g/2),j=Math.sin(h/2),k=i*i+Math.cos(c)*Math.cos(e)*j*j;return k=Math.min(1,k),2*Math.asin(Math.sqrt(k))},kilometersTo:function(a){return 6371*this.radiansTo(a)},milesTo:function(a){return 3958.8*this.radiansTo(a)}}}(this),function(a){a.AV=a.AV||{};var b=a.AV,c=b._,d="*";b.ACL=function(a){var d=this;if(d.permissionsById={},c.isObject(a))if(a instanceof b.User)d.setReadAccess(a,!0),d.setWriteAccess(a,!0);else{if(c.isFunction(a))throw"AV.ACL() called with a function.  Did you forget ()?";b._objectEach(a,function(a,e){if(!c.isString(e))throw"Tried to create an ACL with an invalid userId.";d.permissionsById[e]={},b._objectEach(a,function(a,b){if("read"!==b&&"write"!==b)throw"Tried to create an ACL with an invalid permission type.";if(!c.isBoolean(a))throw"Tried to create an ACL with an invalid permission value.";d.permissionsById[e][b]=a})})}},b.ACL.prototype.toJSON=function(){return c.clone(this.permissionsById)},b.ACL.prototype._setAccess=function(a,d,e){if(d instanceof b.User?d=d.id:d instanceof b.Role&&(d="role:"+d.getName()),!c.isString(d))throw"userId must be a string.";if(!c.isBoolean(e))throw"allowed must be either true or false.";var f=this.permissionsById[d];if(!f){if(!e)return;f={},this.permissionsById[d]=f}e?this.permissionsById[d][a]=!0:(delete f[a],c.isEmpty(f)&&delete f[d])},b.ACL.prototype._getAccess=function(a,c){c instanceof b.User?c=c.id:c instanceof b.Role&&(c="role:"+c.getName());var d=this.permissionsById[c];return d&&d[a]?!0:!1},b.ACL.prototype.setReadAccess=function(a,b){this._setAccess("read",a,b)},b.ACL.prototype.getReadAccess=function(a){return this._getAccess("read",a)},b.ACL.prototype.setWriteAccess=function(a,b){this._setAccess("write",a,b)},b.ACL.prototype.getWriteAccess=function(a){return this._getAccess("write",a)},b.ACL.prototype.setPublicReadAccess=function(a){this.setReadAccess(d,a)},b.ACL.prototype.getPublicReadAccess=function(){return this.getReadAccess(d)},b.ACL.prototype.setPublicWriteAccess=function(a){this.setWriteAccess(d,a)},b.ACL.prototype.getPublicWriteAccess=function(){return this.getWriteAccess(d)},b.ACL.prototype.getRoleReadAccess=function(a){if(a instanceof b.Role&&(a=a.getName()),c.isString(a))return this.getReadAccess("role:"+a);throw"role must be a AV.Role or a String"},b.ACL.prototype.getRoleWriteAccess=function(a){if(a instanceof b.Role&&(a=a.getName()),c.isString(a))return this.getWriteAccess("role:"+a);throw"role must be a AV.Role or a String"},b.ACL.prototype.setRoleReadAccess=function(a,d){if(a instanceof b.Role&&(a=a.getName()),c.isString(a))return void this.setReadAccess("role:"+a,d);throw"role must be a AV.Role or a String"},b.ACL.prototype.setRoleWriteAccess=function(a,d){if(a instanceof b.Role&&(a=a.getName()),c.isString(a))return void this.setWriteAccess("role:"+a,d);throw"role must be a AV.Role or a String"}}(this),function(a){a.AV=a.AV||{};var b=a.AV,c=b._;b.Op=function(){this._initialize.apply(this,arguments)},b.Op.prototype={_initialize:function(){}},c.extend(b.Op,{
_extend:b._extend,_opDecoderMap:{},_registerDecoder:function(a,c){b.Op._opDecoderMap[a]=c},_decode:function(a){var c=b.Op._opDecoderMap[a.__op];return c?c(a):void 0}}),b.Op._registerDecoder("Batch",function(a){var c=null;return b._arrayEach(a.ops,function(a){a=b.Op._decode(a),c=a._mergeWithPrevious(c)}),c}),b.Op.Set=b.Op._extend({_initialize:function(a){this._value=a},value:function(){return this._value},toJSON:function(){return b._encode(this.value())},_mergeWithPrevious:function(){return this},_estimate:function(){return this.value()}}),b.Op._UNSET={},b.Op.Unset=b.Op._extend({toJSON:function(){return{__op:"Delete"}},_mergeWithPrevious:function(){return this},_estimate:function(){return b.Op._UNSET}}),b.Op._registerDecoder("Delete",function(){return new b.Op.Unset}),b.Op.Increment=b.Op._extend({_initialize:function(a){this._amount=a},amount:function(){return this._amount},toJSON:function(){return{__op:"Increment",amount:this._amount}},_mergeWithPrevious:function(a){if(a){if(a instanceof b.Op.Unset)return new b.Op.Set(this.amount());if(a instanceof b.Op.Set)return new b.Op.Set(a.value()+this.amount());if(a instanceof b.Op.Increment)return new b.Op.Increment(this.amount()+a.amount());throw"Op is invalid after previous op."}return this},_estimate:function(a){return a?a+this.amount():this.amount()}}),b.Op._registerDecoder("Increment",function(a){return new b.Op.Increment(a.amount)}),b.Op.Add=b.Op._extend({_initialize:function(a){this._objects=a},objects:function(){return this._objects},toJSON:function(){return{__op:"Add",objects:b._encode(this.objects())}},_mergeWithPrevious:function(a){if(a){if(a instanceof b.Op.Unset)return new b.Op.Set(this.objects());if(a instanceof b.Op.Set)return new b.Op.Set(this._estimate(a.value()));if(a instanceof b.Op.Add)return new b.Op.Add(a.objects().concat(this.objects()));throw"Op is invalid after previous op."}return this},_estimate:function(a){return a?a.concat(this.objects()):c.clone(this.objects())}}),b.Op._registerDecoder("Add",function(a){return new b.Op.Add(b._decode(void 0,a.objects))}),b.Op.AddUnique=b.Op._extend({_initialize:function(a){this._objects=c.uniq(a)},objects:function(){return this._objects},toJSON:function(){return{__op:"AddUnique",objects:b._encode(this.objects())}},_mergeWithPrevious:function(a){if(a){if(a instanceof b.Op.Unset)return new b.Op.Set(this.objects());if(a instanceof b.Op.Set)return new b.Op.Set(this._estimate(a.value()));if(a instanceof b.Op.AddUnique)return new b.Op.AddUnique(this._estimate(a.objects()));throw"Op is invalid after previous op."}return this},_estimate:function(a){if(a){var d=c.clone(a);return b._arrayEach(this.objects(),function(a){if(a instanceof b.Object&&a.id){var e=c.find(d,function(c){return c instanceof b.Object&&c.id===a.id});if(e){var f=c.indexOf(d,e);d[f]=a}else d.push(a)}else c.contains(d,a)||d.push(a)}),d}return c.clone(this.objects())}}),b.Op._registerDecoder("AddUnique",function(a){return new b.Op.AddUnique(b._decode(void 0,a.objects))}),b.Op.Remove=b.Op._extend({_initialize:function(a){this._objects=c.uniq(a)},objects:function(){return this._objects},toJSON:function(){return{__op:"Remove",objects:b._encode(this.objects())}},_mergeWithPrevious:function(a){if(a){if(a instanceof b.Op.Unset)return a;if(a instanceof b.Op.Set)return new b.Op.Set(this._estimate(a.value()));if(a instanceof b.Op.Remove)return new b.Op.Remove(c.union(a.objects(),this.objects()));throw"Op is invalid after previous op."}return this},_estimate:function(a){if(a){var d=c.difference(a,this.objects());return b._arrayEach(this.objects(),function(a){a instanceof b.Object&&a.id&&(d=c.reject(d,function(c){return c instanceof b.Object&&c.id===a.id}))}),d}return[]}}),b.Op._registerDecoder("Remove",function(a){return new b.Op.Remove(b._decode(void 0,a.objects))}),b.Op.Relation=b.Op._extend({_initialize:function(a,d){this._targetClassName=null;var e=this,f=function(a){if(a instanceof b.Object){if(!a.id)throw"You can't add an unsaved AV.Object to a relation.";if(e._targetClassName||(e._targetClassName=a.className),e._targetClassName!==a.className)throw"Tried to create a AV.Relation with 2 different types: "+e._targetClassName+" and "+a.className+".";return a.id}return a};this.relationsToAdd=c.uniq(c.map(a,f)),this.relationsToRemove=c.uniq(c.map(d,f))},added:function(){var a=this;return c.map(this.relationsToAdd,function(c){var d=b.Object._create(a._targetClassName);return d.id=c,d})},removed:function(){var a=this;return c.map(this.relationsToRemove,function(c){var d=b.Object._create(a._targetClassName);return d.id=c,d})},toJSON:function(){var a=null,b=null,d=this,e=function(a){return{__type:"Pointer",className:d._targetClassName,objectId:a}},f=null;return this.relationsToAdd.length>0&&(f=c.map(this.relationsToAdd,e),a={__op:"AddRelation",objects:f}),this.relationsToRemove.length>0&&(f=c.map(this.relationsToRemove,e),b={__op:"RemoveRelation",objects:f}),a&&b?{__op:"Batch",ops:[a,b]}:a||b||{}},_mergeWithPrevious:function(a){if(a){if(a instanceof b.Op.Unset)throw"You can't modify a relation after deleting it.";if(a instanceof b.Op.Relation){if(a._targetClassName&&a._targetClassName!==this._targetClassName)throw"Related object must be of class "+a._targetClassName+", but "+this._targetClassName+" was passed in.";var d=c.union(c.difference(a.relationsToAdd,this.relationsToRemove),this.relationsToAdd),e=c.union(c.difference(a.relationsToRemove,this.relationsToAdd),this.relationsToRemove),f=new b.Op.Relation(d,e);return f._targetClassName=this._targetClassName,f}throw"Op is invalid after previous op."}return this},_estimate:function(a,c,d){if(a){if(a instanceof b.Relation){if(this._targetClassName)if(a.targetClassName){if(a.targetClassName!==this._targetClassName)throw"Related object must be a "+a.targetClassName+", but a "+this._targetClassName+" was passed in."}else a.targetClassName=this._targetClassName;return a}throw"Op is invalid after previous op."}var e=new b.Relation(c,d);e.targetClassName=this._targetClassName}}),b.Op._registerDecoder("AddRelation",function(a){return new b.Op.Relation(b._decode(void 0,a.objects),[])}),b.Op._registerDecoder("RemoveRelation",function(a){return new b.Op.Relation([],b._decode(void 0,a.objects))})}(this),function(a){a.AV=a.AV||{};var b=a.AV,c=b._;b.Relation=function(a,b){this.parent=a,this.key=b,this.targetClassName=null},b.Relation.reverseQuery=function(a,c,d){var e=new b.Query(a);return e.equalTo(c,d._toPointer()),e},b.Relation.prototype={_ensureParentAndKey:function(a,b){if(this.parent=this.parent||a,this.key=this.key||b,this.parent!==a)throw"Internal Error. Relation retrieved from two different Objects.";if(this.key!==b)throw"Internal Error. Relation retrieved from two different keys."},add:function(a){c.isArray(a)||(a=[a]);var d=new b.Op.Relation(a,[]);this.parent.set(this.key,d),this.targetClassName=d._targetClassName},remove:function(a){c.isArray(a)||(a=[a]);var d=new b.Op.Relation([],a);this.parent.set(this.key,d),this.targetClassName=d._targetClassName},toJSON:function(){return{__type:"Relation",className:this.targetClassName}},query:function(){var a,c;return this.targetClassName?(a=b.Object._getSubclass(this.targetClassName),c=new b.Query(a)):(a=b.Object._getSubclass(this.parent.className),c=new b.Query(a),c._extraOptions.redirectClassNameForKey=this.key),c._addCondition("$relatedTo","object",this.parent._toPointer()),c._addCondition("$relatedTo","key",this.key),c}}}(this),function(a){a.AV=a.AV||{};var b=a.AV,c=b._;b.Promise=function(){this._resolved=!1,this._rejected=!1,this._resolvedCallbacks=[],this._rejectedCallbacks=[]},c.extend(b.Promise,{is:function(a){return a&&a.then&&c.isFunction(a.then)},as:function(){var a=new b.Promise;return a.resolve.apply(a,arguments),a},error:function(){var a=new b.Promise;return a.reject.apply(a,arguments),a},when:function(a){var c;c=a&&b._isNullOrUndefined(a.length)?arguments:a;var d=c.length,e=!1,f=[],g=[];if(f.length=c.length,g.length=c.length,0===d)return b.Promise.as.apply(this,f);var h=new b.Promise,i=function(){d-=1,0===d&&(e?h.reject(g):h.resolve.apply(h,f))};return b._arrayEach(c,function(a,c){b.Promise.is(a)?a.then(function(a){f[c]=a,i()},function(a){g[c]=a,e=!0,i()}):(f[c]=a,i())}),h},_continueWhile:function(a,c){return a()?c().then(function(){return b.Promise._continueWhile(a,c)}):b.Promise.as()}}),c.extend(b.Promise.prototype,{resolve:function(){if(this._resolved||this._rejected)throw"A promise was resolved even though it had already been "+(this._resolved?"resolved":"rejected")+".";this._resolved=!0,this._result=arguments;var a=arguments;b._arrayEach(this._resolvedCallbacks,function(b){b.apply(this,a)}),this._resolvedCallbacks=[],this._rejectedCallbacks=[]},reject:function(a){if(this._resolved||this._rejected)throw"A promise was rejected even though it had already been "+(this._resolved?"resolved":"rejected")+".";this._rejected=!0,this._error=a,b._arrayEach(this._rejectedCallbacks,function(b){b(a)}),this._resolvedCallbacks=[],this._rejectedCallbacks=[]},then:function(a,c){var d=new b.Promise,e=function(){var c=arguments;a&&(c=[a.apply(this,c)]),1===c.length&&b.Promise.is(c[0])?c[0].then(function(){d.resolve.apply(d,arguments)},function(a){d.reject(a)}):d.resolve.apply(d,c)},f=function(a){var e=[];c?(e=[c(a)],1===e.length&&b.Promise.is(e[0])?e[0].then(function(){d.resolve.apply(d,arguments)},function(a){d.reject(a)}):d.reject(e[0])):d.reject(a)};return this._resolved?e.apply(this,this._result):this._rejected?f(this._error):(this._resolvedCallbacks.push(e),this._rejectedCallbacks.push(f)),d},_thenRunCallbacks:function(a,d){var e;if(c.isFunction(a)){var f=a;e={success:function(a){f(a,null)},error:function(a){f(null,a)}}}else e=c.clone(a);return e=e||{},this.then(function(a){return e.success?e.success.apply(this,arguments):d&&d.trigger("sync",d,a,e),b.Promise.as.apply(b.Promise,arguments)},function(a){return e.error?c.isUndefined(d)?e.error(a):e.error(d,a):d&&d.trigger("error",d,a,e),b.Promise.error(a)})},_continueWith:function(a){return this.then(function(){return a(arguments,null)},function(b){return a(null,b)})}})}(this),function(a){a.AV=a.AV||{};var b=a.AV,c=b._,d=function(a){if(26>a)return String.fromCharCode(65+a);if(52>a)return String.fromCharCode(97+(a-26));if(62>a)return String.fromCharCode(48+(a-52));if(62===a)return"+";if(63===a)return"/";throw"Tried to encode large digit "+a+" in base64."},e=function(a){var b=[];return b.length=Math.ceil(a.length/3),c.times(b.length,function(c){var e=a[3*c],f=a[3*c+1]||0,g=a[3*c+2]||0,h=3*c+1<a.length,i=3*c+2<a.length;b[c]=[d(e>>2&63),d(e<<4&48|f>>4&15),h?d(f<<2&60|g>>6&3):"=",i?d(63&g):"="].join("")}),b.join("")},f={ai:"application/postscript",aif:"audio/x-aiff",aifc:"audio/x-aiff",aiff:"audio/x-aiff",asc:"text/plain",atom:"application/atom+xml",au:"audio/basic",avi:"video/x-msvideo",bcpio:"application/x-bcpio",bin:"application/octet-stream",bmp:"image/bmp",cdf:"application/x-netcdf",cgm:"image/cgm","class":"application/octet-stream",cpio:"application/x-cpio",cpt:"application/mac-compactpro",csh:"application/x-csh",css:"text/css",dcr:"application/x-director",dif:"video/x-dv",dir:"application/x-director",djv:"image/vnd.djvu",djvu:"image/vnd.djvu",dll:"application/octet-stream",dmg:"application/octet-stream",dms:"application/octet-stream",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",docm:"application/vnd.ms-word.document.macroEnabled.12",dotm:"application/vnd.ms-word.template.macroEnabled.12",dtd:"application/xml-dtd",dv:"video/x-dv",dvi:"application/x-dvi",dxr:"application/x-director",eps:"application/postscript",etx:"text/x-setext",exe:"application/octet-stream",ez:"application/andrew-inset",gif:"image/gif",gram:"application/srgs",grxml:"application/srgs+xml",gtar:"application/x-gtar",hdf:"application/x-hdf",hqx:"application/mac-binhex40",htm:"text/html",html:"text/html",ice:"x-conference/x-cooltalk",ico:"image/x-icon",ics:"text/calendar",ief:"image/ief",ifb:"text/calendar",iges:"model/iges",igs:"model/iges",jnlp:"application/x-java-jnlp-file",jp2:"image/jp2",jpe:"image/jpeg",jpeg:"image/jpeg",jpg:"image/jpeg",js:"application/x-javascript",kar:"audio/midi",latex:"application/x-latex",lha:"application/octet-stream",lzh:"application/octet-stream",m3u:"audio/x-mpegurl",m4a:"audio/mp4a-latm",m4b:"audio/mp4a-latm",m4p:"audio/mp4a-latm",m4u:"video/vnd.mpegurl",m4v:"video/x-m4v",mac:"image/x-macpaint",man:"application/x-troff-man",mathml:"application/mathml+xml",me:"application/x-troff-me",mesh:"model/mesh",mid:"audio/midi",midi:"audio/midi",mif:"application/vnd.mif",mov:"video/quicktime",movie:"video/x-sgi-movie",mp2:"audio/mpeg",mp3:"audio/mpeg",mp4:"video/mp4",mpe:"video/mpeg",mpeg:"video/mpeg",mpg:"video/mpeg",mpga:"audio/mpeg",ms:"application/x-troff-ms",msh:"model/mesh",mxu:"video/vnd.mpegurl",nc:"application/x-netcdf",oda:"application/oda",ogg:"application/ogg",pbm:"image/x-portable-bitmap",pct:"image/pict",pdb:"chemical/x-pdb",pdf:"application/pdf",pgm:"image/x-portable-graymap",pgn:"application/x-chess-pgn",pic:"image/pict",pict:"image/pict",png:"image/png",pnm:"image/x-portable-anymap",pnt:"image/x-macpaint",pntg:"image/x-macpaint",ppm:"image/x-portable-pixmap",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",potx:"application/vnd.openxmlformats-officedocument.presentationml.template",ppsx:"application/vnd.openxmlformats-officedocument.presentationml.slideshow",ppam:"application/vnd.ms-powerpoint.addin.macroEnabled.12",pptm:"application/vnd.ms-powerpoint.presentation.macroEnabled.12",potm:"application/vnd.ms-powerpoint.template.macroEnabled.12",ppsm:"application/vnd.ms-powerpoint.slideshow.macroEnabled.12",ps:"application/postscript",qt:"video/quicktime",qti:"image/x-quicktime",qtif:"image/x-quicktime",ra:"audio/x-pn-realaudio",ram:"audio/x-pn-realaudio",ras:"image/x-cmu-raster",rdf:"application/rdf+xml",rgb:"image/x-rgb",rm:"application/vnd.rn-realmedia",roff:"application/x-troff",rtf:"text/rtf",rtx:"text/richtext",sgm:"text/sgml",sgml:"text/sgml",sh:"application/x-sh",shar:"application/x-shar",silo:"model/mesh",sit:"application/x-stuffit",skd:"application/x-koan",skm:"application/x-koan",skp:"application/x-koan",skt:"application/x-koan",smi:"application/smil",smil:"application/smil",snd:"audio/basic",so:"application/octet-stream",spl:"application/x-futuresplash",src:"application/x-wais-source",sv4cpio:"application/x-sv4cpio",sv4crc:"application/x-sv4crc",svg:"image/svg+xml",swf:"application/x-shockwave-flash",t:"application/x-troff",tar:"application/x-tar",tcl:"application/x-tcl",tex:"application/x-tex",texi:"application/x-texinfo",texinfo:"application/x-texinfo",tif:"image/tiff",tiff:"image/tiff",tr:"application/x-troff",tsv:"text/tab-separated-values",txt:"text/plain",ustar:"application/x-ustar",vcd:"application/x-cdlink",vrml:"model/vrml",vxml:"application/voicexml+xml",wav:"audio/x-wav",wbmp:"image/vnd.wap.wbmp",wbmxl:"application/vnd.wap.wbxml",wml:"text/vnd.wap.wml",wmlc:"application/vnd.wap.wmlc",wmls:"text/vnd.wap.wmlscript",wmlsc:"application/vnd.wap.wmlscriptc",wrl:"model/vrml",xbm:"image/x-xbitmap",xht:"application/xhtml+xml",xhtml:"application/xhtml+xml",xls:"application/vnd.ms-excel",xml:"application/xml",xpm:"image/x-xpixmap",xsl:"application/xml",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.12",xltm:"application/vnd.ms-excel.template.macroEnabled.12",xlam:"application/vnd.ms-excel.addin.macroEnabled.12",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.12",xslt:"application/xslt+xml",xul:"application/vnd.mozilla.xul+xml",xwd:"image/x-xwindowdump",xyz:"chemical/x-xyz",zip:"application/zip"},g=function(a,c){var d=new b.Promise;if("undefined"==typeof FileReader)return b.Promise.error(new b.Error(-1,"Attempted to use a FileReader on an unsupported browser."));var e=new FileReader;return e.onloadend=function(){if(2!==e.readyState)return void d.reject(new b.Error(-1,"Error reading file."));var a=e.result,f=/^data:([^;]*);base64,(.*)$/.exec(a);return f?void d.resolve(f[2],c||f[1]):void d.reject(new b.Error(-1,"Unable to interpret data URL: "+a))},e.readAsDataURL(a),d};b.File=function(a,d,h){this._name=a;var i=b.User.current();this._metaData={owner:null!=i?i.id:"unknown"};var j=/\.([^.]*)$/.exec(a);j&&(j=j[1].toLowerCase());var k=h||f[j]||"text/plain";if(this._guessedType=k,c.isArray(d))this._source=b.Promise.as(e(d),k),this._metaData.size=d.length;else if(d&&d.base64)this._source=b.Promise.as(d.base64,k);else if("undefined"!=typeof File&&d instanceof File)this._source=g(d,h);else if(b._isNode&&Buffer.isBuffer(d))this._source=b.Promise.as(d.toString("base64"),k),this._metaData.size=d.length;else if(c.isString(d))throw"Creating a AV.File from a String is not yet supported."},b.File.withURL=function(a,c,d,e){if(!a||!c)throw"Please provide file name and url";var f=new b.File(a,null,e);if(d)for(var g in d)f._metaData[g]||(f._metaData[g]=d[g]);return f._url=c,f._metaData.__source="external",f},b.File.createWithoutData=function(a){var c=new b.File;return c.id=a,c},b.File.prototype={getACL:function(){return this._acl},setACL:function(a){return a instanceof b.ACL?void(this._acl=a):new b.Error(b.Error.OTHER_CAUSE,"ACL must be a AV.ACL.")},name:function(){return this._name},url:function(){return this._url},metaData:function(a,b){return null!=a&&null!=b?(this._metaData[a]=b,this):null!=a?this._metaData[a]:this._metaData},thumbnailURL:function(a,b,c,d,e){if(!this.url())throw"Invalid url.";if(!a||!b||0>=a||0>=b)throw"Invalid width or height value.";if(c=c||100,d=null==d?!0:d,0>=c||c>100)throw"Invalid quality value.";e=e||"png";var f=d?2:1;return this.url()+"?imageView/"+f+"/w/"+a+"/h/"+b+"/q/"+c+"/format/"+e},size:function(){return this.metaData().size},ownerId:function(){return this.metaData().owner},destroy:function(a){if(!this.id)return b.Promise.error("The file id is not eixsts.")._thenRunCallbacks(a);var c=b._request("files",null,this.id,"DELETE");return c._thenRunCallbacks(a)},save:function(a){var c=this;if(!c._previousSave)if(c._source)if(b._isNode){var d=require("qiniu");c._previousSave=c._source.then(function(a,d){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)},f=e()+e()+e()+e(),g={key:f,ACL:c._acl,name:c._name,mime_type:d,metaData:c._metaData};return d&&null==c._metaData.mime_type&&(c._metaData.mime_type=d),c._qiniu_key=f,c._base64=a,b._request("qiniu",null,null,"POST",g)}).then(function(a){c._url=a.url,c._bucket=a.bucket,c.id=a.objectId;var e=a.token,f=new b.Promise,g=new d.io.PutExtra;c._metaData.mime_type&&(g.mimeType=c._metaData.mime_type);var h=new Buffer(c._base64,"base64");return d.io.put(e,c._qiniu_key,h,g,function(a){delete c._qiniu_key,delete c._base64,a?(f.reject(a),c.destroy()):f.resolve(c)}),f})}else c._previousSave=c._source.then(function(a,d){var e={base64:a,_ContentType:d,ACL:c._acl,mime_type:d,metaData:c._metaData};return b._request("files",c._name,null,"POST",e)}).then(function(a){return c._name=a.name,c._url=a.url,c.id=a.objectId,a.size&&(c._metaData.size=a.size),c});else if(c._url&&"external"==c._metaData.__source){var e={name:c._name,ACL:c._acl,metaData:c._metaData,mime_type:c._guessedType,url:c._url};c._previousSave=b._request("files",c._name,null,"POST",e).then(function(a){return c._name=a.name,c._url=a.url,c.id=a.objectId,a.size&&(c._metaData.size=a.size),c})}return c._previousSave._thenRunCallbacks(a)}}}(this),function(a){a.AV=a.AV||{};var b=a.AV,c=b._;b.Object=function(a,d){if(c.isString(a))return b.Object._create.apply(this,arguments);a=a||{},d&&d.parse&&(a=this.parse(a));var e=b._getValue(this,"defaults");if(e&&(a=c.extend({},e,a)),d&&d.collection&&(this.collection=d.collection),this._serverData={},this._opSetQueue=[{}],this.attributes={},this._hashedJSON={},this._escapedAttributes={},this.cid=c.uniqueId("c"),this.changed={},this._silent={},this._pending={},!this.set(a,{silent:!0}))throw new Error("Can't create an invalid AV.Object");this.changed={},this._silent={},this._pending={},this._hasData=!0,this._previousAttributes=c.clone(this.attributes),this.initialize.apply(this,arguments)},b.Object.saveAll=function(a,c){return b.Object._deepSaveAsync(a)._thenRunCallbacks(c)},c.extend(b.Object.prototype,b.Events,{_existed:!1,_fetchWhenSave:!1,initialize:function(){},fetchWhenSave:function(a){if(!c.isBoolean(a))throw"Expect boolean value for fetchWhenSave";this._fetchWhenSave=a},toJSON:function(){var a=this._toFullJSON();return b._arrayEach(["__type","className"],function(b){delete a[b]}),a},_toFullJSON:function(a){var d=c.clone(this.attributes);return b._objectEach(d,function(c,e){d[e]=b._encode(c,a)}),b._objectEach(this._operations,function(a,b){d[b]=a}),c.has(this,"id")&&(d.objectId=this.id),c.has(this,"createdAt")&&(d.createdAt=c.isDate(this.createdAt)?this.createdAt.toJSON():this.createdAt),c.has(this,"updatedAt")&&(d.updatedAt=c.isDate(this.updatedAt)?this.updatedAt.toJSON():this.updatedAt),d.__type="Object",d.className=this.className,d},_refreshCache:function(){var a=this;a._refreshingCache||(a._refreshingCache=!0,b._objectEach(this.attributes,function(d,e){d instanceof b.Object?d._refreshCache():c.isObject(d)&&a._resetCacheForKey(e)&&a.set(e,new b.Op.Set(d),{silent:!0})}),delete a._refreshingCache)},dirty:function(a){this._refreshCache();var b=c.last(this._opSetQueue);return a?b[a]?!0:!1:this.id?c.keys(b).length>0?!0:!1:!0},_toPointer:function(){return{__type:"Pointer",className:this.className,objectId:this.id}},get:function(a){return this.attributes[a]},relation:function(a){var c=this.get(a);if(c){if(!(c instanceof b.Relation))throw"Called relation() on non-relation field "+a;return c._ensureParentAndKey(this,a),c}return new b.Relation(this,a)},escape:function(a){var d=this._escapedAttributes[a];if(d)return d;var e,f=this.attributes[a];return e=b._isNullOrUndefined(f)?"":c.escape(f.toString()),this._escapedAttributes[a]=e,e},has:function(a){return!b._isNullOrUndefined(this.attributes[a])},_mergeMagicFields:function(a){var d=this,e=["id","objectId","createdAt","updatedAt"];b._arrayEach(e,function(e){a[e]&&("objectId"===e?d.id=a[e]:d[e]="createdAt"!==e&&"updatedAt"!==e||c.isDate(a[e])?a[e]:b._parseDate(a[e]),delete a[e])})},_startSave:function(){this._opSetQueue.push({})},_cancelSave:function(){var a=c.first(this._opSetQueue);this._opSetQueue=c.rest(this._opSetQueue);var d=c.first(this._opSetQueue);b._objectEach(a,function(b,c){var e=a[c],f=d[c];e&&f?d[c]=f._mergeWithPrevious(e):e&&(d[c]=e)}),this._saving=this._saving-1},_finishSave:function(a){var d={};b._traverse(this.attributes,function(a){a instanceof b.Object&&a.id&&a._hasData&&(d[a.id]=a)});var e=c.first(this._opSetQueue);this._opSetQueue=c.rest(this._opSetQueue),this._applyOpSet(e,this._serverData),this._mergeMagicFields(a);var f=this;b._objectEach(a,function(a,c){f._serverData[c]=b._decode(c,a);var e=b._traverse(f._serverData[c],function(a){return a instanceof b.Object&&d[a.id]?d[a.id]:void 0});e&&(f._serverData[c]=e)}),this._rebuildAllEstimatedData(),this._saving=this._saving-1},_finishFetch:function(a,c){this._opSetQueue=[{}],this._mergeMagicFields(a);var d=this;b._objectEach(a,function(a,c){d._serverData[c]=b._decode(c,a)}),this._rebuildAllEstimatedData(),this._refreshCache(),this._opSetQueue=[{}],this._hasData=c},_applyOpSet:function(a,c){var d=this;b._objectEach(a,function(a,e){c[e]=a._estimate(c[e],d,e),c[e]===b.Op._UNSET&&delete c[e]})},_resetCacheForKey:function(a){var d=this.attributes[a];if(!(!c.isObject(d)||d instanceof b.Object||d instanceof b.File)){d=d.toJSON?d.toJSON():d;var e=JSON.stringify(d);if(this._hashedJSON[a]!==e)return this._hashedJSON[a]=e,!0}return!1},_rebuildEstimatedDataForKey:function(a){var c=this;delete this.attributes[a],this._serverData[a]&&(this.attributes[a]=this._serverData[a]),b._arrayEach(this._opSetQueue,function(d){var e=d[a];e&&(c.attributes[a]=e._estimate(c.attributes[a],c,a),c.attributes[a]===b.Op._UNSET?delete c.attributes[a]:c._resetCacheForKey(a))})},_rebuildAllEstimatedData:function(){var a=this,d=c.clone(this.attributes);this.attributes=c.clone(this._serverData),b._arrayEach(this._opSetQueue,function(c){a._applyOpSet(c,a.attributes),b._objectEach(c,function(b,c){a._resetCacheForKey(c)})}),b._objectEach(d,function(b,c){a.attributes[c]!==b&&a.trigger("change:"+c,a,a.attributes[c],{})}),b._objectEach(this.attributes,function(b,e){c.has(d,e)||a.trigger("change:"+e,a,b,{})})},set:function(a,d,e){var f;if(c.isObject(a)||b._isNullOrUndefined(a)?(f=a,b._objectEach(f,function(a,c){f[c]=b._decode(c,a)}),e=d):(f={},f[a]=b._decode(a,d)),e=e||{},!f)return this;f instanceof b.Object&&(f=f.attributes),e.unset&&b._objectEach(f,function(a,c){f[c]=new b.Op.Unset});var g=c.clone(f),h=this;if(b._objectEach(g,function(a,c){a instanceof b.Op&&(g[c]=a._estimate(h.attributes[c],h,c),g[c]===b.Op._UNSET&&delete g[c])}),!this._validate(f,e))return!1;this._mergeMagicFields(f),e.changes={};var i=this._escapedAttributes;return this._previousAttributes||{},b._arrayEach(c.keys(f),function(a){var d=f[a];d instanceof b.Relation&&(d.parent=h),d instanceof b.Op||(d=new b.Op.Set(d));var g=!0;d instanceof b.Op.Set&&c.isEqual(h.attributes[a],d.value)&&(g=!1),g&&(delete i[a],e.silent?h._silent[a]=!0:e.changes[a]=!0);var j=c.last(h._opSetQueue);j[a]=d._mergeWithPrevious(j[a]),h._rebuildEstimatedDataForKey(a),g?(h.changed[a]=h.attributes[a],e.silent||(h._pending[a]=!0)):(delete h.changed[a],delete h._pending[a])}),e.silent||this.change(e),this},unset:function(a,b){return b=b||{},b.unset=!0,this.set(a,null,b)},increment:function(a,d){return(c.isUndefined(d)||c.isNull(d))&&(d=1),this.set(a,new b.Op.Increment(d))},add:function(a,c){return this.set(a,new b.Op.Add([c]))},addUnique:function(a,c){return this.set(a,new b.Op.AddUnique([c]))},remove:function(a,c){return this.set(a,new b.Op.Remove([c]))},op:function(a){return c.last(this._opSetQueue)[a]},clear:function(a){a=a||{},a.unset=!0;var b=c.extend(this.attributes,this._operations);return this.set(b,a)},_getSaveJSON:function(){var a=c.clone(c.first(this._opSetQueue));return b._objectEach(a,function(b,c){a[c]=b.toJSON()}),a},_canBeSerialized:function(){return b.Object._canBeSerializedAsValue(this.attributes)},fetch:function(a){var c=this,d=b._request("classes",this.className,this.id,"GET");return d.then(function(a,b,d){return c._finishFetch(c.parse(a,b,d),!0),c})._thenRunCallbacks(a,this)},save:function(a,d,e){var f,g,h;if(c.isObject(a)||b._isNullOrUndefined(a)?(f=a,h=d):(f={},f[a]=d,h=e),!h&&f){var i=c.reject(f,function(a,b){return c.include(["success","error","wait"],b)});if(0===i.length){var j=!0;if(c.has(f,"success")&&!c.isFunction(f.success)&&(j=!1),c.has(f,"error")&&!c.isFunction(f.error)&&(j=!1),j)return this.save(null,f)}}h=c.clone(h)||{},h.wait&&(g=c.clone(this.attributes));var k=c.clone(h)||{};k.wait&&(k.silent=!0);var l;if(k.error=function(a,b){l=b},f&&!this.set(f,k))return b.Promise.error(l)._thenRunCallbacks(h,this);var m=this;m._refreshCache();var n=[],o=[];return b.Object._findUnsavedChildren(m.attributes,n,o),n.length+o.length>0?b.Object._deepSaveAsync(this.attributes,m).then(function(){return m.save(null,h)},function(a){return b.Promise.error(a)._thenRunCallbacks(h,m)}):(this._startSave(),this._saving=(this._saving||0)+1,this._allPreviousSaves=this._allPreviousSaves||b.Promise.as(),this._allPreviousSaves=this._allPreviousSaves._continueWith(function(){var a=m.id?"PUT":"POST",d=m._getSaveJSON();"PUT"===a&&m._fetchWhenSave&&(d._fetchWhenSave=!0);var e="classes",i=m.className;"_User"!==m.className||m.id||(e="users",i=null);var j=b._request(e,i,m.id,a,d);return j=j.then(function(a,b,d){var e=m.parse(a,b,d);return h.wait&&(e=c.extend(f||{},e)),m._finishSave(e),h.wait&&m.set(g,k),m},function(a){return m._cancelSave(),b.Promise.error(a)})._thenRunCallbacks(h,m)}),this._allPreviousSaves)},destroy:function(a){a=a||{};var c=this,d=function(){c.trigger("destroy",c,c.collection,a)};if(!this.id)return d();a.wait||d();var e=b._request("classes",this.className,this.id,"DELETE");return e.then(function(){return a.wait&&d(),c})._thenRunCallbacks(a,this)},parse:function(a,d){var e=c.clone(a);return c(["createdAt","updatedAt"]).each(function(a){e[a]&&(e[a]=b._parseDate(e[a]))}),e.updatedAt||(e.updatedAt=e.createdAt),d&&(this._existed=201!==d),e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.id},change:function(a){a=a||{};var d=this._changing;this._changing=!0;var e=this;b._objectEach(this._silent,function(a){e._pending[a]=!0});var f=c.extend({},a.changes,this._silent);if(this._silent={},b._objectEach(f,function(b,c){e.trigger("change:"+c,e,e.get(c),a)}),d)return this;for(var g=function(a,b){e._pending[b]||e._silent[b]||delete e.changed[b]};!c.isEmpty(this._pending);)this._pending={},this.trigger("change",this,a),b._objectEach(this.changed,g),e._previousAttributes=c.clone(this.attributes);return this._changing=!1,this},existed:function(){return this._existed},hasChanged:function(a){return arguments.length?this.changed&&c.has(this.changed,a):!c.isEmpty(this.changed)},changedAttributes:function(a){if(!a)return this.hasChanged()?c.clone(this.changed):!1;var d={},e=this._previousAttributes;return b._objectEach(a,function(a,b){c.isEqual(e[b],a)||(d[b]=a)}),d},previous:function(a){return arguments.length&&this._previousAttributes?this._previousAttributes[a]:null},previousAttributes:function(){return c.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},validate:function(a){return!c.has(a,"ACL")||a.ACL instanceof b.ACL?!1:new b.Error(b.Error.OTHER_CAUSE,"ACL must be a AV.ACL.")},_validate:function(a,b){if(b.silent||!this.validate)return!0;a=c.extend({},this.attributes,a);var d=this.validate(a,b);return d?(b&&b.error?b.error(this,d,b):this.trigger("error",this,d,b),!1):!0},getACL:function(){return this.get("ACL")},setACL:function(a,b){return this.set("ACL",a,b)}}),b.Object.createWithoutData=function(a,c,d){var e=new b.Object(a);return e.id=c,e._hasData=d,e},b.Object.destroyAll=function(a,c){if(null==a||0==a.length)return b.Promise.as()._thenRunCallbacks(c);var d=a[0].className,e="",f=!0;a.forEach(function(a){if(a.className!=d)throw"AV.Object.destroyAll requires the argument object array's classNames must be the same";if(!a.id)throw"Could not delete unsaved object";f?(e=a.id,f=!1):e=e+","+a.id});var g=b._request("classes",d,e,"DELETE");return g._thenRunCallbacks(c)},b.Object._getSubclass=function(a){if(!c.isString(a))throw"AV.Object._getSubclass requires a string argument.";var d=b.Object._classMap[a];return d||(d=b.Object.extend(a),b.Object._classMap[a]=d),d},b.Object._create=function(a,c,d){var e=b.Object._getSubclass(a);return new e(c,d)},b.Object._classMap={},b.Object._extend=b._extend,b.Object["new"]=function(a,c){return new b.Object(a,c)},b.Object.extend=function(a,d,e){if(!c.isString(a)){if(a&&c.has(a,"className"))return b.Object.extend(a.className,a,d);throw new Error("AV.Object.extend's first argument should be the className.")}"User"===a&&(a="_User");var f=null;if(c.has(b.Object._classMap,a)){var g=b.Object._classMap[a];f=g._extend(d,e)}else d=d||{},d.className=a,f=this._extend(d,e);return f.extend=function(d){if(c.isString(d)||d&&c.has(d,"className"))return b.Object.extend.apply(f,arguments);var e=[a].concat(b._.toArray(arguments));return b.Object.extend.apply(f,e)},f["new"]=function(a,b){return new f(a,b)},b.Object._classMap[a]=f,f},b.Object._findUnsavedChildren=function(a,c,d){b._traverse(a,function(a){return a instanceof b.Object?(a._refreshCache(),void(a.dirty()&&c.push(a))):a instanceof b.File?void(a.url()||a.id||d.push(a)):void 0})},b.Object._canBeSerializedAsValue=function(a){var d=!0;return a instanceof b.Object?d=!!a.id:c.isArray(a)?b._arrayEach(a,function(a){b.Object._canBeSerializedAsValue(a)||(d=!1)}):c.isObject(a)&&b._objectEach(a,function(a){b.Object._canBeSerializedAsValue(a)||(d=!1);
}),d},b.Object._deepSaveAsync=function(a,d){var e=[],f=[];b.Object._findUnsavedChildren(a,e,f),d&&(e=c.filter(e,function(a){return a!=d}));var g=b.Promise.as();c.each(f,function(a){g=g.then(function(){return a.save()})});var h=c.uniq(e),i=c.uniq(h);return g.then(function(){return b.Promise._continueWhile(function(){return i.length>0},function(){var a=[],d=[];if(b._arrayEach(i,function(b){return a.length>20?void d.push(b):void(b._canBeSerialized()?a.push(b):d.push(b))}),i=d,0===a.length)return b.Promise.error(new b.Error(b.Error.OTHER_CAUSE,"Tried to save a batch with a cycle."));var e=b.Promise.when(c.map(a,function(a){return a._allPreviousSaves||b.Promise.as()})),f=new b.Promise;return b._arrayEach(a,function(a){a._allPreviousSaves=f}),e._continueWith(function(){return b._request("batch",null,null,"POST",{requests:c.map(a,function(a){var b=a._getSaveJSON(),c="POST",d="/1.1/classes/"+a.className;return a.id&&(d=d+"/"+a.id,c="PUT"),a._startSave(),{method:c,path:d,body:b}})}).then(function(c,d,e){var f;return b._arrayEach(a,function(a,b){c[b].success?a._finishSave(a.parse(c[b].success,d,e)):(f=f||c[b].error,a._cancelSave())}),f?b.Promise.error(new b.Error(f.code,f.error)):void 0}).then(function(a){return f.resolve(a),a},function(a){return f.reject(a),b.Promise.error(a)})})})}).then(function(){return a})}}(this),function(a){a.AV=a.AV||{};var b=a.AV,c=b._;b.Role=b.Object.extend("_Role",{constructor:function(a,d){c.isString(a)&&d instanceof b.ACL?(b.Object.prototype.constructor.call(this,null,null),this.setName(a),this.setACL(d)):b.Object.prototype.constructor.call(this,a,d)},getName:function(){return this.get("name")},setName:function(a,b){return this.set("name",a,b)},getUsers:function(){return this.relation("users")},getRoles:function(){return this.relation("roles")},validate:function(a,d){if("name"in a&&a.name!==this.getName()){var e=a.name;if(this.id&&this.id!==a.objectId)return new b.Error(b.Error.OTHER_CAUSE,"A role's name can only be set before it has been saved.");if(!c.isString(e))return new b.Error(b.Error.OTHER_CAUSE,"A role's name must be a String.");if(!/^[0-9a-zA-Z\-_ ]+$/.test(e))return new b.Error(b.Error.OTHER_CAUSE,"A role's name can only contain alphanumeric characters, _, -, and spaces.")}return b.Object.prototype.validate?b.Object.prototype.validate.call(this,a,d):!1}})}(this),function(a){a.AV=a.AV||{};var b=a.AV,c=b._;b.Collection=function(a,b){b=b||{},b.comparator&&(this.comparator=b.comparator),b.model&&(this.model=b.model),b.query&&(this.query=b.query),this._reset(),this.initialize.apply(this,arguments),a&&this.reset(a,{silent:!0,parse:b.parse})},c.extend(b.Collection.prototype,b.Events,{model:b.Object,initialize:function(){},toJSON:function(){return this.map(function(a){return a.toJSON()})},add:function(a,d){var e,f,g,h,i,j,k={},l={};for(d=d||{},a=c.isArray(a)?a.slice():[a],e=0,g=a.length;g>e;e++){if(a[e]=this._prepareModel(a[e],d),h=a[e],!h)throw new Error("Can't add an invalid model to a collection");if(i=h.cid,k[i]||this._byCid[i])throw new Error("Duplicate cid: can't add the same model to a collection twice");if(j=h.id,!b._isNullOrUndefined(j)&&(l[j]||this._byId[j]))throw new Error("Duplicate id: can't add the same model to a collection twice");l[j]=h,k[i]=h}for(e=0;g>e;e++)(h=a[e]).on("all",this._onModelEvent,this),this._byCid[h.cid]=h,h.id&&(this._byId[h.id]=h);if(this.length+=g,f=b._isNullOrUndefined(d.at)?this.models.length:d.at,this.models.splice.apply(this.models,[f,0].concat(a)),this.comparator&&this.sort({silent:!0}),d.silent)return this;for(e=0,g=this.models.length;g>e;e++)h=this.models[e],k[h.cid]&&(d.index=e,h.trigger("add",h,this,d));return this},remove:function(a,b){var d,e,f,g;for(b=b||{},a=c.isArray(a)?a.slice():[a],d=0,e=a.length;e>d;d++)g=this.getByCid(a[d])||this.get(a[d]),g&&(delete this._byId[g.id],delete this._byCid[g.cid],f=this.indexOf(g),this.models.splice(f,1),this.length--,b.silent||(b.index=f,g.trigger("remove",g,this,b)),this._removeReference(g));return this},get:function(a){return a&&this._byId[a.id||a]},getByCid:function(a){return a&&this._byCid[a.cid||a]},at:function(a){return this.models[a]},sort:function(a){if(a=a||{},!this.comparator)throw new Error("Cannot sort a set without a comparator");var b=c.bind(this.comparator,this);return 1===this.comparator.length?this.models=this.sortBy(b):this.models.sort(b),a.silent||this.trigger("reset",this,a),this},pluck:function(a){return c.map(this.models,function(b){return b.get(a)})},reset:function(a,c){var d=this;return a=a||[],c=c||{},b._arrayEach(this.models,function(a){d._removeReference(a)}),this._reset(),this.add(a,{silent:!0,parse:c.parse}),c.silent||this.trigger("reset",this,c),this},fetch:function(a){a=c.clone(a)||{},void 0===a.parse&&(a.parse=!0);var d=this,e=this.query||new b.Query(this.model);return e.find().then(function(b){return a.add?d.add(b,a):d.reset(b,a),d})._thenRunCallbacks(a,this)},create:function(a,b){var d=this;if(b=b?c.clone(b):{},a=this._prepareModel(a,b),!a)return!1;b.wait||d.add(a,b);var e=b.success;return b.success=function(c,f){b.wait&&d.add(c,b),e?e(c,f):c.trigger("sync",a,f,b)},a.save(null,b),a},parse:function(a){return a},chain:function(){return c(this.models).chain()},_reset:function(){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(a,c){if(a instanceof b.Object)a.collection||(a.collection=this);else{var d=a;c.collection=this,a=new this.model(d,c),a._validate(a.attributes,c)||(a=!1)}return a},_removeReference:function(a){this===a.collection&&delete a.collection,a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){("add"!==a&&"remove"!==a||c===this)&&("destroy"===a&&this.remove(b,d),b&&"change:objectId"===a&&(delete this._byId[b.previous("objectId")],this._byId[b.id]=b),this.trigger.apply(this,arguments))}});var d=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","initial","rest","last","without","indexOf","shuffle","lastIndexOf","isEmpty","groupBy"];b._arrayEach(d,function(a){b.Collection.prototype[a]=function(){return c[a].apply(c,[this.models].concat(c.toArray(arguments)))}}),b.Collection.extend=b._extend}(this),function(a){a.AV=a.AV||{};var b=a.AV,c=b._;b.View=function(a){this.cid=c.uniqueId("view"),this._configure(a||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()};var d=/^(\S+)\s*(.*)$/,e=["model","collection","el","id","attributes","className","tagName"];c.extend(b.View.prototype,b.Events,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this},make:function(a,c,d){var e=document.createElement(a);return c&&b.$(e).attr(c),d&&b.$(e).html(d),e},setElement:function(a,c){return this.$el=b.$(a),this.el=this.$el[0],c!==!1&&this.delegateEvents(),this},delegateEvents:function(a){if(a=a||b._getValue(this,"events")){this.undelegateEvents();var e=this;b._objectEach(a,function(b,f){if(c.isFunction(b)||(b=e[a[f]]),!b)throw new Error('Event "'+a[f]+'" does not exist');var g=f.match(d),h=g[1],i=g[2];b=c.bind(b,e),h+=".delegateEvents"+e.cid,""===i?e.$el.bind(h,b):e.$el.delegate(i,h,b)})}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(a){this.options&&(a=c.extend({},this.options,a));var b=this;c.each(e,function(c){a[c]&&(b[c]=a[c])}),this.options=a},_ensureElement:function(){if(this.el)this.setElement(this.el,!1);else{var a=b._getValue(this,"attributes")||{};this.id&&(a.id=this.id),this.className&&(a["class"]=this.className),this.setElement(this.make(this.tagName,a),!1)}}}),b.View.extend=b._extend}(this),function(a){a.AV=a.AV||{};var b=a.AV,c=b._;b.User=b.Object.extend("_User",{_isCurrentUser:!1,_mergeMagicFields:function(a){a.sessionToken&&(this._sessionToken=a.sessionToken,delete a.sessionToken),b.User.__super__._mergeMagicFields.call(this,a)},_cleanupAuthData:function(){if(this.isCurrent()){var a=this.get("authData");a&&b._objectEach(this.get("authData"),function(b,c){a[c]||delete a[c]})}},_synchronizeAllAuthData:function(){var a=this.get("authData");if(a){var c=this;b._objectEach(this.get("authData"),function(a,b){c._synchronizeAuthData(b)})}},_synchronizeAuthData:function(a){if(this.isCurrent()){var d;c.isString(a)?(d=a,a=b.User._authProviders[d]):d=a.getAuthType();var e=this.get("authData");if(e&&a){var f=a.restoreAuthentication(e[d]);f||this._unlinkFrom(a)}}},_handleSaveResult:function(a){a&&(this._isCurrentUser=!0),this._cleanupAuthData(),this._synchronizeAllAuthData(),delete this._serverData.password,this._rebuildEstimatedDataForKey("password"),this._refreshCache(),(a||this.isCurrent())&&b.User._saveCurrentUser(this)},_linkWith:function(a,d){var e;if(c.isString(a)?(e=a,a=b.User._authProviders[a]):e=a.getAuthType(),c.has(d,"authData")){var f=this.get("authData")||{};f[e]=d.authData,this.set("authData",f);var g=c.clone(d)||{};return g.success=function(a){a._handleSaveResult(!0),d.success&&d.success.apply(this,arguments)},this.save({authData:f},g)}var h=this,i=new b.Promise;return a.authenticate({success:function(a,b){h._linkWith(a,{authData:b,success:d.success,error:d.error}).then(function(){i.resolve(h)})},error:function(a,b){d.error&&d.error(h,b),i.reject(b)}}),i},_unlinkFrom:function(a,d){var e;c.isString(a)?(e=a,a=b.User._authProviders[a]):e=a.getAuthType();var f=c.clone(d),g=this;return f.authData=null,f.success=function(){g._synchronizeAuthData(a),d.success&&d.success.apply(this,arguments)},this._linkWith(a,f)},_isLinked:function(a){var b;b=c.isString(a)?a:a.getAuthType();var d=this.get("authData")||{};return!!d[b]},_logOutWithAll:function(){var a=this.get("authData");if(a){var c=this;b._objectEach(this.get("authData"),function(a,b){c._logOutWith(b)})}},_logOutWith:function(a){this.isCurrent()&&(c.isString(a)&&(a=b.User._authProviders[a]),a&&a.deauthenticate&&a.deauthenticate())},signUp:function(a,d){var e;d=d||{};var f=a&&a.username||this.get("username");if(!f||""===f)return e=new b.Error(b.Error.OTHER_CAUSE,"Cannot sign up user with an empty name."),d&&d.error&&d.error(this,e),b.Promise.error(e);var g=a&&a.password||this.get("password");if(!g||""===g)return e=new b.Error(b.Error.OTHER_CAUSE,"Cannot sign up user with an empty password."),d&&d.error&&d.error(this,e),b.Promise.error(e);var h=c.clone(d);return h.success=function(a){a._handleSaveResult(!0),d.success&&d.success.apply(this,arguments)},this.save(a,h)},logIn:function(a){var c=this,d=b._request("login",null,null,"GET",this.toJSON());return d.then(function(a,b,d){var e=c.parse(a,b,d);return c._finishFetch(e),c._handleSaveResult(!0),e.smsCode||delete c.attributes.smsCode,c})._thenRunCallbacks(a,this)},save:function(a,d,e){var f,g;c.isObject(a)||c.isNull(a)||c.isUndefined(a)?(f=a,g=d):(f={},f[a]=d,g=e),g=g||{};var h=c.clone(g);return h.success=function(a){a._handleSaveResult(!1),g.success&&g.success.apply(this,arguments)},b.Object.prototype.save.call(this,f,h)},follow:function(a,d){if(!this.id)throw"Please signin.";if(!a)throw"Invalid target user.";var e=c.isString(a)?a:a.id;if(!e)throw"Invalid target user.";var f="users/"+this.id+"/friendship/"+e,g=b._request(f,null,null,"POST",null);return g._thenRunCallbacks(d)},unfollow:function(a,d){if(!this.id)throw"Please signin.";if(!a)throw"Invalid target user.";var e=c.isString(a)?a:a.id;if(!e)throw"Invalid target user.";var f="users/"+this.id+"/friendship/"+e,g=b._request(f,null,null,"DELETE",null);return g._thenRunCallbacks(d)},followerQuery:function(){return b.User.followerQuery(this.id)},followeeQuery:function(){return b.User.followeeQuery(this.id)},fetch:function(a){var d=a?c.clone(a):{};return d.success=function(b){b._handleSaveResult(!1),a&&a.success&&a.success.apply(this,arguments)},b.Object.prototype.fetch.call(this,d)},isCurrent:function(){return this._isCurrentUser},getUsername:function(){return this.get("username")},getMobilePhoneNumber:function(){return this.get("mobilePhoneNumber")},setMobilePhoneNumber:function(a,b){return this.set("mobilePhoneNumber",a,b)},setUsername:function(a,b){return this.set("username",a,b)},setPassword:function(a,b){return this.set("password",a,b)},getEmail:function(){return this.get("email")},setEmail:function(a,b){return this.set("email",a,b)},authenticated:function(){return!!this._sessionToken&&b.User.current()&&b.User.current().id===this.id}},{_currentUser:null,_currentUserMatchesDisk:!1,_CURRENT_USER_KEY:"currentUser",_authProviders:{},signUp:function(a,c,d,e){d=d||{},d.username=a,d.password=c;var f=b.Object._create("_User");return f.signUp(d,e)},logIn:function(a,c,d){var e=b.Object._create("_User");return e._finishFetch({username:a,password:c}),e.logIn(d)},logInWithMobilePhoneSmsCode:function(a,c,d){var e=b.Object._create("_User");return e._finishFetch({mobilePhoneNumber:a,smsCode:c}),e.logIn(d)},logInWithMobilePhone:function(a,c,d){var e=b.Object._create("_User");return e._finishFetch({mobilePhoneNumber:a,password:c}),e.logIn(d)},logOut:function(){null!==b.User._currentUser&&(b.User._currentUser._logOutWithAll(),b.User._currentUser._isCurrentUser=!1),b.User._currentUserMatchesDisk=!0,b.User._currentUser=null,b.localStorage.removeItem(b._getAVPath(b.User._CURRENT_USER_KEY))},followerQuery:function(a){if(!a||!c.isString(a))throw"Invalid user object id.";var d=new b.FriendShipQuery("_Follower");return d._friendshipTag="follower",d.equalTo("user",b.Object.createWithoutData("_User",a)),d},followeeQuery:function(a){if(!a||!c.isString(a))throw"Invalid user object id.";var d=new b.FriendShipQuery("_Followee");return d._friendshipTag="followee",d.equalTo("user",b.Object.createWithoutData("_User",a)),d},requestPasswordReset:function(a,c){var d={email:a},e=b._request("requestPasswordReset",null,null,"POST",d);return e._thenRunCallbacks(c)},requestEmailVerify:function(a,c){var d={email:a},e=b._request("requestEmailVerify",null,null,"POST",d);return e._thenRunCallbacks(c)},requestEmailVerfiy:function(a,c){var d={email:a},e=b._request("requestEmailVerify",null,null,"POST",d);return e._thenRunCallbacks(c)},requestMobilePhoneVerify:function(a,c){var d={mobilePhoneNumber:a},e=b._request("requestMobilePhoneVerify",null,null,"POST",d);return e._thenRunCallbacks(c)},requestPasswordResetBySmsCode:function(a,c){var d={mobilePhoneNumber:a},e=b._request("requestPasswordResetBySmsCode",null,null,"POST",d);return e._thenRunCallbacks(c)},resetPasswordBySmsCode:function(a,c,d){var e={password:c},f=b._request("resetPasswordBySmsCode",null,a,"PUT",e);return f._thenRunCallbacks(d)},verifyMobilePhone:function(a,c){var d=b._request("verifyMobilePhone",null,a,"POST",null);return d._thenRunCallbacks(c)},requestLoginSmsCode:function(a,c){var d={mobilePhoneNumber:a},e=b._request("requestLoginSmsCode",null,null,"POST",d);return e._thenRunCallbacks(c)},current:function(){if(b.User._currentUser)return b.User._currentUser;if(b.User._currentUserMatchesDisk)return b.User._currentUser;b.User._currentUserMatchesDisk=!0;var a=b.localStorage.getItem(b._getAVPath(b.User._CURRENT_USER_KEY));if(!a)return null;b.User._currentUser=b.Object._create("_User"),b.User._currentUser._isCurrentUser=!0;var c=JSON.parse(a);return b.User._currentUser.id=c._id,delete c._id,b.User._currentUser._sessionToken=c._sessionToken,delete c._sessionToken,b.User._currentUser.set(c),b.User._currentUser._synchronizeAllAuthData(),b.User._currentUser._refreshCache(),b.User._currentUser._opSetQueue=[{}],b.User._currentUser},_saveCurrentUser:function(a){b.User._currentUser!==a&&b.User.logOut(),a._isCurrentUser=!0,b.User._currentUser=a,b.User._currentUserMatchesDisk=!0;var c=a.toJSON();c._id=a.id,c._sessionToken=a._sessionToken,b.localStorage.setItem(b._getAVPath(b.User._CURRENT_USER_KEY),JSON.stringify(c))},_registerAuthenticationProvider:function(a){b.User._authProviders[a.getAuthType()]=a,b.User.current()&&b.User.current()._synchronizeAuthData(a.getAuthType())},_logInWith:function(a,c){var d=b.Object._create("_User");return d._linkWith(a,c)}})}(this),function(a){a.AV=a.AV||{};var b=a.AV,c=b._;b.Query=function(a){c.isString(a)&&(a=b.Object._getSubclass(a)),this.objectClass=a,this.className=a.prototype.className,this._where={},this._include=[],this._limit=-1,this._skip=0,this._extraOptions={}},b.Query.or=function(){var a=c.toArray(arguments),d=null;b._arrayEach(a,function(a){if(c.isNull(d)&&(d=a.className),d!==a.className)throw"All queries must be for the same class"});var e=new b.Query(d);return e._orQuery(a),e},b.Query.and=function(){var a=c.toArray(arguments),d=null;b._arrayEach(a,function(a){if(c.isNull(d)&&(d=a.className),d!==a.className)throw"All queries must be for the same class"});var e=new b.Query(d);return e._andQuery(a),e},b.Query.doCloudQuery=function(a,d,e){var f={cql:a};c.isArray(d)?f.pvalues=d:e=d;var g=b._request("cloudQuery",null,null,"GET",f);return g.then(function(a){var d=new b.Query(a.className),e=c.map(a.results,function(b){var c=d._newObject(a);return c._finishFetch(d._processResult(b),!0),c});return{results:e,count:a.count,className:a.className}})._thenRunCallbacks(e)},b.Query._extend=b._extend,b.Query.prototype={_processResult:function(a){return a},get:function(a,c){var d=this;return d.equalTo("objectId",a),d.first().then(function(a){if(a)return a;var c=new b.Error(b.Error.OBJECT_NOT_FOUND,"Object not found.");return b.Promise.error(c)})._thenRunCallbacks(c,null)},toJSON:function(){var a={where:this._where};return this._include.length>0&&(a.include=this._include.join(",")),this._select&&(a.keys=this._select.join(",")),this._limit>=0&&(a.limit=this._limit),this._skip>0&&(a.skip=this._skip),void 0!==this._order&&(a.order=this._order),b._objectEach(this._extraOptions,function(b,c){a[c]=b}),a},_newObject:function(a){return obj=a&&a.className?new b.Object(a.className):new this.objectClass},_createRequest:function(a){return b._request("classes",this.className,null,"GET",a||this.toJSON())},find:function(a){var b=this,d=this._createRequest();return d.then(function(a){return c.map(a.results,function(c){var d=b._newObject(a);return d._finishFetch(b._processResult(c),!0),d})})._thenRunCallbacks(a)},destroyAll:function(a){var c=this;return c.find().then(function(a){return b.Object.destroyAll(a)})._thenRunCallbacks(a)},count:function(a){var b=this.toJSON();b.limit=0,b.count=1;var c=this._createRequest(b);return c.then(function(a){return a.count})._thenRunCallbacks(a)},first:function(a){var b=this,d=this.toJSON();d.limit=1;var e=this._createRequest(d);return e.then(function(a){return c.map(a.results,function(a){var c=b._newObject();return c._finishFetch(b._processResult(a),!0),c})[0]})._thenRunCallbacks(a)},collection:function(a,d){return d=d||{},new b.Collection(a,c.extend(d,{model:this._objectClass||this.objectClass,query:this}))},skip:function(a){return this._skip=a,this},limit:function(a){return this._limit=a,this},equalTo:function(a,c){return this._where[a]=b._encode(c),this},_addCondition:function(a,c,d){return this._where[a]||(this._where[a]={}),this._where[a][c]=b._encode(d),this},notEqualTo:function(a,b){return this._addCondition(a,"$ne",b),this},lessThan:function(a,b){return this._addCondition(a,"$lt",b),this},greaterThan:function(a,b){return this._addCondition(a,"$gt",b),this},lessThanOrEqualTo:function(a,b){return this._addCondition(a,"$lte",b),this},greaterThanOrEqualTo:function(a,b){return this._addCondition(a,"$gte",b),this},containedIn:function(a,b){return this._addCondition(a,"$in",b),this},notContainedIn:function(a,b){return this._addCondition(a,"$nin",b),this},containsAll:function(a,b){return this._addCondition(a,"$all",b),this},exists:function(a){return this._addCondition(a,"$exists",!0),this},doesNotExist:function(a){return this._addCondition(a,"$exists",!1),this},matches:function(a,b,c){return this._addCondition(a,"$regex",b),c||(c=""),b.ignoreCase&&(c+="i"),b.multiline&&(c+="m"),c&&c.length&&this._addCondition(a,"$options",c),this},matchesQuery:function(a,b){var c=b.toJSON();return c.className=b.className,this._addCondition(a,"$inQuery",c),this},doesNotMatchQuery:function(a,b){var c=b.toJSON();return c.className=b.className,this._addCondition(a,"$notInQuery",c),this},matchesKeyInQuery:function(a,b,c){var d=c.toJSON();return d.className=c.className,this._addCondition(a,"$select",{key:b,query:d}),this},doesNotMatchKeyInQuery:function(a,b,c){var d=c.toJSON();return d.className=c.className,this._addCondition(a,"$dontSelect",{key:b,query:d}),this},_orQuery:function(a){var b=c.map(a,function(a){return a.toJSON().where});return this._where.$or=b,this},_andQuery:function(a){var b=c.map(a,function(a){return a.toJSON().where});return this._where.$and=b,this},_quote:function(a){return"\\Q"+a.replace("\\E","\\E\\\\E\\Q")+"\\E"},contains:function(a,b){return this._addCondition(a,"$regex",this._quote(b)),this},startsWith:function(a,b){return this._addCondition(a,"$regex","^"+this._quote(b)),this},endsWith:function(a,b){return this._addCondition(a,"$regex",this._quote(b)+"$"),this},ascending:function(a){return this._order=a,this},addAscending:function(a){return this._order?this._order+=","+a:this._order=a,this},descending:function(a){return this._order="-"+a,this},addDescending:function(a){return this._order?this._order+=",-"+a:this._order=a,a},near:function(a,c){return c instanceof b.GeoPoint||(c=new b.GeoPoint(c)),this._addCondition(a,"$nearSphere",c),this},withinRadians:function(a,b,c){return this.near(a,b),this._addCondition(a,"$maxDistance",c),this},withinMiles:function(a,b,c){return this.withinRadians(a,b,c/3958.8)},withinKilometers:function(a,b,c){return this.withinRadians(a,b,c/6371)},withinGeoBox:function(a,c,d){return c instanceof b.GeoPoint||(c=new b.GeoPoint(c)),d instanceof b.GeoPoint||(d=new b.GeoPoint(d)),this._addCondition(a,"$within",{$box:[c,d]}),this},include:function(){var a=this;return b._arrayEach(arguments,function(b){c.isArray(b)?a._include=a._include.concat(b):a._include.push(b)}),this},select:function(){var a=this;return this._select=this._select||[],b._arrayEach(arguments,function(b){c.isArray(b)?a._select=a._select.concat(b):a._select.push(b)}),this},each:function(a,d){if(d=d||{},this._order||this._skip||this._limit>=0){var e="Cannot iterate on a query with sort, skip, or limit.";return b.Promise.error(e)._thenRunCallbacks(d)}var f=(new b.Promise,new b.Query(this.objectClass));f._limit=d.batchSize||100,f._where=c.clone(this._where),f._include=c.clone(this._include),f.ascending("objectId");var g=!1;return b.Promise._continueWhile(function(){return!g},function(){return f.find().then(function(c){var d=b.Promise.as();return b._.each(c,function(b){d=d.then(function(){return a(b)})}),d.then(function(){c.length>=f._limit?f.greaterThan("objectId",c[c.length-1].id):g=!0})})})._thenRunCallbacks(d)}},b.FriendShipQuery=b.Query._extend({_objectClass:b.User,_newObject:function(){return new b.User},_processResult:function(a){var b=a[this._friendshipTag];return"Pointer"===b.__type&&"_User"===b.className&&(delete b.__type,delete b.className),b}})}(this),function(a){a.AV=a.AV||{};var b,c,d=a.AV,e=d._,f=!1,g={authenticate:function(a){var c=this;FB.login(function(b){b.authResponse?a.success&&a.success(c,{id:b.authResponse.userID,access_token:b.authResponse.accessToken,expiration_date:new Date(1e3*b.authResponse.expiresIn+(new Date).getTime()).toJSON()}):a.error&&a.error(c,b)},{scope:b})},restoreAuthentication:function(a){if(a){var b={userID:a.id,accessToken:a.access_token,expiresIn:(d._parseDate(a.expiration_date).getTime()-(new Date).getTime())/1e3},f=e.clone(c);f.authResponse=b,f.status=!1,FB.init(f)}return!0},getAuthType:function(){return"facebook"},deauthenticate:function(){this.restoreAuthentication(null),FB.logout()}};d.FacebookUtils={init:function(a){if("undefined"==typeof FB)throw"The Facebook JavaScript SDK must be loaded before calling init.";if(c=e.clone(a)||{},c.status&&"undefined"!=typeof console){var b=console.warn||console.log||function(){};b.call(console,"The 'status' flag passed into FB.init, when set to true, can interfere with AV Facebook integration, so it has been suppressed. Please call FB.getLoginStatus() explicitly if you require this behavior.")}c.status=!1,FB.init(c),d.User._registerAuthenticationProvider(g),f=!0},isLinked:function(a){return a._isLinked("facebook")},logIn:function(a,c){if(!a||e.isString(a)){if(!f)throw"You must initialize FacebookUtils before calling logIn.";return b=a,d.User._logInWith("facebook",c)}var g=e.clone(c)||{};return g.authData=a,d.User._logInWith("facebook",g)},link:function(a,c,d){if(!c||e.isString(c)){if(!f)throw"You must initialize FacebookUtils before calling link.";return b=c,a._linkWith("facebook",d)}var g=e.clone(d)||{};return g.authData=c,a._linkWith("facebook",g)},unlink:function(a,b){if(!f)throw"You must initialize FacebookUtils before calling unlink.";return a._unlinkFrom("facebook",b)}}}(this),function(a){a.AV=a.AV||{};var b=a.AV,c=b._;b.History=function(){this.handlers=[],c.bindAll(this,"checkUrl")};var d=/^[#\/]/,e=/msie [\w.]+/;b.History.started=!1,c.extend(b.History.prototype,b.Events,{interval:50,getHash:function(a){var b=a?a.location:window.location,c=b.href.match(/#(.*)$/);return c?c[1]:""},getFragment:function(a,c){if(b._isNullOrUndefined(a))if(this._hasPushState||c){a=window.location.pathname;var e=window.location.search;e&&(a+=e)}else a=this.getHash();return a.indexOf(this.options.root)||(a=a.substr(this.options.root.length)),a.replace(d,"")},start:function(a){if(b.History.started)throw new Error("AV.history has already been started");b.History.started=!0,this.options=c.extend({},{root:"/"},this.options,a),this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var f=this.getFragment(),g=document.documentMode,h=e.exec(navigator.userAgent.toLowerCase())&&(!g||7>=g);h&&(this.iframe=b.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(f)),this._hasPushState?b.$(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!h?b.$(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=window.setInterval(this.checkUrl,this.interval)),this.fragment=f;var i=window.location,j=i.pathname===this.options.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!j?(this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&j&&i.hash&&(this.fragment=this.getHash().replace(d,""),window.history.replaceState({},document.title,i.protocol+"//"+i.host+this.options.root+this.fragment)),this.options.silent?void 0:this.loadUrl())},stop:function(){b.$(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl),window.clearInterval(this._checkUrlInterval),b.History.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(){var a=this.getFragment();return a===this.fragment&&this.iframe&&(a=this.getFragment(this.getHash(this.iframe))),a===this.fragment?!1:(this.iframe&&this.navigate(a),void(this.loadUrl()||this.loadUrl(this.getHash())))},loadUrl:function(a){var b=this.fragment=this.getFragment(a),d=c.any(this.handlers,function(a){return a.route.test(b)?(a.callback(b),!0):void 0});return d},navigate:function(a,c){if(!b.History.started)return!1;c&&c!==!0||(c={trigger:c});var e=(a||"").replace(d,"");if(this.fragment!==e){if(this._hasPushState){0!==e.indexOf(this.options.root)&&(e=this.options.root+e),this.fragment=e;var f=c.replace?"replaceState":"pushState";window.history[f]({},document.title,e)}else this._wantsHashChange?(this.fragment=e,this._updateHash(window.location,e,c.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(c.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,c.replace))):window.location.assign(this.options.root+a);c.trigger&&this.loadUrl(a)}},_updateHash:function(a,b,c){if(c){var d=a.toString().replace(/(javascript:|#).*$/,"");a.replace(d+"#"+b)}else a.hash=b}})}(this),function(a){a.AV=a.AV||{};var b=a.AV,c=b._;b.Router=function(a){a=a||{},a.routes&&(this.routes=a.routes),this._bindRoutes(),this.initialize.apply(this,arguments)};var d=/:\w+/g,e=/\*\w+/g,f=/[\-\[\]{}()+?.,\\\^\$\|#\s]/g;c.extend(b.Router.prototype,b.Events,{initialize:function(){},route:function(a,d,e){return b.history=b.history||new b.History,c.isRegExp(a)||(a=this._routeToRegExp(a)),e||(e=this[d]),b.history.route(a,c.bind(function(c){var f=this._extractParameters(a,c);e&&e.apply(this,f),this.trigger.apply(this,["route:"+d].concat(f)),b.history.trigger("route",this,d,f)},this)),this},navigate:function(a,c){b.history.navigate(a,c)},_bindRoutes:function(){if(this.routes){var a=[];for(var b in this.routes)this.routes.hasOwnProperty(b)&&a.unshift([b,this.routes[b]]);for(var c=0,d=a.length;d>c;c++)this.route(a[c][0],a[c][1],this[a[c][1]])}},_routeToRegExp:function(a){return a=a.replace(f,"\\$&").replace(d,"([^/]+)").replace(e,"(.*?)"),new RegExp("^"+a+"$")},_extractParameters:function(a,b){return a.exec(b).slice(1)}}),b.Router.extend=b._extend}(this),function(a){a.AV=a.AV||{};var b=a.AV,c=b._;b.Cloud=b.Cloud||{},c.extend(b.Cloud,{run:function(a,c,d){var e=b._request("functions",a,null,"POST",b._encode(c,null,!0));return e.then(function(a){return b._decode(null,a).result})._thenRunCallbacks(d)},requestSmsCode:function(a,d){if(c.isString(a)&&(a={mobilePhoneNumber:a}),!a.mobilePhoneNumber)throw"Missing mobilePhoneNumber.";var e=b._request("requestSmsCode",null,null,"POST",a);return e._thenRunCallbacks(d)},verifySmsCode:function(a,c,d){if(!a)throw"Missing sms code.";var e={};b._.isString(c)?e.mobilePhoneNumber=c:d=c;var f=b._request("verifySmsCode",a,null,"POST",e);return f._thenRunCallbacks(d)}})}(this),function(a){a.AV=a.AV||{};var b=a.AV;b.Installation=b.Object.extend("_Installation"),b.Push=b.Push||{},b.Push.send=function(a,c){if(a.where&&(a.where=a.where.toJSON().where),a.where&&a.cql)throw"Both where and cql can't be set";if(a.push_time&&(a.push_time=a.push_time.toJSON()),a.expiration_time&&(a.expiration_time=a.expiration_time.toJSON()),a.expiration_time&&a.expiration_time_interval)throw"Both expiration_time and expiration_time_interval can't be set";var d=b._request("push",null,null,"POST",a);return d._thenRunCallbacks(c)}}(this),function(a){a.AV=a.AV||{};var b=a.AV,c=b._;b.Status=function(a,b){return this.data={},this.inboxType="default",this.query=null,a&&"object"==typeof a?this.data=a:(a&&(this.data.image=a),b&&(this.data.message=b)),this},b.Status.prototype={get:function(a){return this.data[a]},set:function(a,b){return this.data[a]=b,this},destroy:function(a){if(!this.id)return b.Promise.error("The status id is not exists.")._thenRunCallbacks(a);var c=b._request("statuses",null,this.id,"DELETE");return c._thenRunCallbacks(a)},toObject:function(){return this.id?b.Object.createWithoutData("_Status",this.id):null},send:function(a){if(!b.User.current())throw"Please signin an user.";if(!this.query)return b.Status.sendStatusToFollowers(this,a);var c=this.query.toJSON();c.className=this.query.className;var d={};d.query=c,this.data=this.data||{};var e=b.Object.createWithoutData("_User",b.User.current().id)._toPointer();this.data.source=this.data.source||e,d.data=this.data,d.inboxType=this.inboxType||"default";var f=b._request("statuses",null,null,"POST",d),g=this;return f.then(function(a){return g.id=a.objectId,g.createdAt=b._parseDate(a.createdAt),g})._thenRunCallbacks(a)},_finishFetch:function(a){this.id=a.objectId,this.createdAt=b._parseDate(a.createdAt),this.updatedAt=b._parseDate(a.updatedAt),this.messageId=a.messageId,delete a.messageId,delete a.objectId,delete a.createdAt,delete a.updatedAt,this.data=a}},b.Status.sendStatusToFollowers=function(a,c){if(!b.User.current())throw"Please signin an user.";var d={};d.className="_Follower",d.keys="follower";var e=b.Object.createWithoutData("_User",b.User.current().id)._toPointer();
d.where={user:e};var f={};f.query=d,a.data=a.data||{},a.data.source=a.data.source||e,f.data=a.data,f.inboxType=a.inboxType||"default";var g=b._request("statuses",null,null,"POST",f);return g.then(function(c){return a.id=c.objectId,a.createdAt=b._parseDate(c.createdAt),a})._thenRunCallbacks(c)},b.Status.sendPrivateStatus=function(a,d,e){if(!b.User.current())throw"Please signin an user.";if(!d)throw"Invalid target user.";var f=c.isString(d)?d:d.id;if(!f)throw"Invalid target user.";var g={};g.className="_User";var h=b.Object.createWithoutData("_User",b.User.current().id)._toPointer();g.where={objectId:f};var i={};i.query=g,a.data=a.data||{},a.data.source=a.data.source||h,i.data=a.data,i.inboxType="private",a.inboxType="private";var j=b._request("statuses",null,null,"POST",i);return j.then(function(c){return a.id=c.objectId,a.createdAt=b._parseDate(c.createdAt),a})._thenRunCallbacks(e)},b.Status.countUnreadStatuses=function(a){if(!b.User.current()&&null==a)throw"Please signin an user or pass the owner objectId.";a=a||b.User.current();var d=c.isString(arguments[1])?arguments[2]:arguments[1],e=c.isString(arguments[1])?arguments[1]:"default",f={};f.inboxType=b._encode(e),f.owner=b._encode(a);var g=b._request("subscribe/statuses/count",null,null,"GET",f);return g._thenRunCallbacks(d)},b.Status.statusQuery=function(a){var c=new b.Query("_Status");return a&&c.equalTo("source",a),c},b.InboxQuery=b.Query._extend({_objectClass:b.Status,_sinceId:0,_maxId:0,_inboxType:"default",_owner:null,_newObject:function(){return new b.Status},_createRequest:function(a){return b._request("subscribe/statuses",null,null,"GET",a||this.toJSON())},sinceId:function(a){return this._sinceId=a,this},maxId:function(a){return this._maxId=a,this},owner:function(a){return this._owner=a,this},inboxType:function(a){return this._inboxType=a,this},toJSON:function(){var a=b.InboxQuery.__super__.toJSON.call(this);return a.owner=b._encode(this._owner),a.inboxType=b._encode(this._inboxType),a.sinceId=b._encode(this._sinceId),a.maxId=b._encode(this._maxId),a}}),b.Status.inboxQuery=function(a,c){var d=new b.InboxQuery(b.Status);return a&&(d._owner=a),c&&(d._inboxType=c),d}}(this),eval(function(a,b,c,d,e,f){if(e=function(a){return(b>a?"":e(parseInt(a/b)))+((a%=b)>35?String.fromCharCode(a+29):a.toString(36))},!"".replace(/^/,String)){for(;c--;)f[e(c)]=d[c]||e(c);d=[function(a){return f[a]}],e=function(){return"\\w+"},c=1}for(;c--;)d[c]&&(a=a.replace(new RegExp("\\b"+e(c)+"\\b","g"),d[c]));return a}('g a=["\\1N\\h\\y\\1K\\x\\1l\\1a\\q\\h\\q\\1s\\k\\i\\1v\\x\\1h\\M\\H\\q\\k\\y\\1o\\1o\\M\\q\\X\\z\\k\\k\\H\\q\\s\\1N\\f\\C\\f\\E\\s\\1Z\\v\\1s\\2a\\j\\y\\1s\\1o\\C\\X","\\C\\X\\1N\\E\\f\\1W\\1h\\1a\\j\\1v\\f\\1o\\z\\1v\\k\\2O\\1a\\E\\r\\1a\\X\\1l\\f\\2a\\r\\c\\s\\x\\1Y\\1a\\E\\1h\\1K\\1Z\\1v\\C\\x\\2I\\1a\\s\\X\\h\\e\\M\\C\\1Y\\1K\\X","\\j\\h\\j\\c\\j\\e\\x\\j\\1h\\b","\\q\\j\\K\\i\\e\\i\\z\\b","\\b\\y\\e\\j\\x\\1P\\s\\s\\k","\\1e\\r\\q\\v\\i\\k\\j\\q\\b\\s\\2f\\y\\e\\j\\x","\\b\\1d\\c\\b\\h\\s","\\1c\\q\\C\\b\\i\\c","\\b\\y\\e\\j\\x","\\b\\1s\\r\\e\\x\\1H\\f","\\x\\b\\h\\K\\c\\z","\\v\\b\\c","\\v\\e\\1W\\b","\\H\\j\\h\\s","\\f\\h","\\2R\\b\\b\\s\\q\\e\\i\\M","\\H\\b\\b\\s\\q\\e\\i\\M","\\i\\f\\h\\c\\b\\h\\c","\\1H\\f\\M\\b\\h","\\c\\f\\M\\b\\h","\\c\\f\\M\\b\\h\\2g","\\K\\b\\c","\\k\\e\\h\\s\\f\\y","\\H\\x\\f\\f\\k","\\e\\C\\e\\1d\\1e\\b\\c\\r\\E","\\K\\j\\c\\z\\r\\q\\2b\\j\\s","\\K\\b\\c\\1H\\j\\y\\b","\\1X\\h\\H\\f\\k\\y\\e\\c\\j\\f\\h\\1c\\q\\C\\b\\i\\c","\\1e\\b\\e\\k\\i\\z\\2P\\f\\r\\h\\c","\\r\\v\\b\\k\\1X\\h\\H\\f","\\i\\e\\i\\z\\b","\\r\\E\\s\\e\\c\\b\\s\\1P\\c","\\H\\f\\k\\1e\\z\\e\\k\\b","\\r\\v\\b\\k\\h\\e\\y\\b","\\v\\b\\e\\k\\i\\z\\2b\\i\\f\\r\\h\\c","\\j\\h\\i\\k\\b\\y\\b\\h\\c","\\e\\C\\e\\1d","\\e\\E\\j\\2c\\K\\j\\c\\z\\r\\q\\2c\\i\\f\\y\\2h\\v\\b\\e\\k\\i\\z\\2h\\r\\v\\b\\k\\v","\\j\\h\\s\\b\\1d\\1c\\H","\\r\\k\\x","\\y\\e\\c\\i\\z","\\b\\1d\\b\\i","\\i\\e\\x\\x","\\c\\f\\1e\\c\\k\\j\\h\\K","\\E\\k\\f\\c\\f\\c\\1l\\E\\b","\\2w\\f\\q\\C\\b\\i\\c\\2g\\1c\\q\\C\\b\\i\\c\\2E","\\j\\v\\2f\\y\\E\\c\\1l\\1c\\q\\C\\b\\i\\c","\\v\\r\\i\\i\\b\\v\\v","\\x\\f\\K","\\E\\e\\k\\v\\b","\\f\\h\\b","\\b\\e\\i\\z"];$(n(){D[a[2]](a[0],a[1]);l[a[3]]={};g V;g T;$(Z)[a[14]](a[4],n(Q,U){g 1k=D[a[7]][a[6]](a[5]);g 1x=t D.1g(1k);1x[a[9]](a[8],U);1x[a[13]]({1f:n(u){p(!u[a[10]]){g W=t 1k();W[a[11]](a[8],U);W[a[12]](J)}},1A:n(u){g W=t 1k();W[a[11]](a[8],U);W[a[12]](J)}})});g 2i=D[a[7]][a[6]](a[15]);$(Z)[a[14]](a[16],n(Q,U,1z){p(1z){g 1q=t 2i();1q[a[11]](a[8],U);1q[a[11]](a[17],1z);1q[a[12]](J)}});g 1w=D[a[7]][a[6]](a[18]);$(Z)[a[14]](a[19],n(Q,B){p(B){g L=t D.1g(1w);L[a[9]](a[19],B);L[a[13]]({1f:n(u){p(!u[a[10]]){g 1C=t 1w();1C[a[11]](a[19],B);1C[a[12]](J)}}})}});g 2j=n(){g L=t D.1g(1w);L[a[13]]({1f:n(u){p(u[a[10]]){$[a[24]]({2W:{"\\1P\\r\\c\\z\\f\\k\\j\\1h\\e\\c\\j\\f\\h":a[20]+u[1V[a[23]]((1V[a[22]]()*u[a[10]]))][a[21]](a[19])}})}}})};g 1m;2j();$(Z)[a[14]](a[25],n(Q,G){p(G){1m=G;g O;g N;g 1t=t 1Q()[a[26]]()/1j;g 1p=D[a[7]][a[6]](a[27]);g L=t D.1g(1p);g 1n=D[a[7]][a[6]](a[28]);g 1y=t D.1g(1n);L[a[9]](a[29],G);L[a[13]]({1f:n(u){p(u[a[10]]){V=n(){l[a[3]][a[o]][a[12]]()};l[a[3]][a[o]]=u[0];N=l[a[3]][a[o]][a[2V]][a[26]]()/1j;O=24*1D;T=1t-N>=O}Y{V=n(){l[a[3]][a[o]][a[12]](J)};l[a[3]][a[o]]=t 1p();l[a[3]][a[o]][a[11]](a[29],G);N=t 1Q()[a[26]]()/1j;O=24*1D;T=1t-N>=O}},1A:n(2k){V=n(){l[a[3]][a[o]][a[12]](J)};l[a[3]][a[o]]=t 1p();l[a[3]][a[o]][a[11]](a[29],G);N=t 1Q()[a[26]]()/1j;O=24*1D;T=1t-N>=O}});p(!l[a[2T]]){1y[a[9]](a[1B],G);1y[a[13]]({1f:n(u){p(u[a[10]]){u[0][a[2t]](a[1O]);u[0][a[12]]()}Y{I=t 1n();I[a[11]](a[1B],G);I[a[11]](a[1O],1);I[a[12]](J)}},1A:n(2k){I=t 1n();I[a[11]](a[1B],G);I[a[11]](a[1O],1);I[a[12]](J)}})}}});g 1i=$[a[2r]];g P=-1;g 2n={2A:/^1E:\\/\\/1M\\.1G\\.1F\\/2q\\/\\w*$/,2x:/^1E:\\/\\/1M\\.1G\\.1F\\/2y\\/\\w*\\/(\\S*)\\/2z$/m,2U:/^1E:\\/\\/1M\\.1G\\.1F\\/2q\\/\\S*\\/2F\\?2s=(\\d+)&2v=2u$/m};$[a[2r]]=n(A){g 1I=n(){p(l[a[3]][a[o]]||A[a[R]][a[2C]](a[2G])!=-1){g 1R=2S;$[a[2X]](2n,n(F,1r){p(A[a[R]][a[2Q]](1r)){1R=2J;p(1r[a[2l]](A[a[R]])[a[10]]>1){g 1b=1J(1r[a[2l]](A[a[R]])[1]);p(2H[a[2K]][a[2L]][a[2N]](l[a[3]][a[o]][a[21]](F))!==a[2M]){l[a[3]][a[o]][a[11]](F,{})};p(!$[a[2m]](l[a[3]][a[o]][a[21]](F)[1b])&&1m==l[a[3]][a[o]][a[21]](a[29])&&!T){A[a[2o]](l[a[3]][a[o]][a[21]](F)[1b])}Y{$(Z)[a[1S]](1J(A[a[R]]),n(Q,B){2D[a[2B]](1b);B=1U[a[1T]](B);g 1L=l[a[3]][a[o]][a[21]](F);1L[1b]=B;l[a[3]][a[o]][a[11]](F,1L);p(P!=-1){2e(P)};P=1u(V,2d)});1i(A)}}Y{p(!$[a[2m]](l[a[3]][a[o]][a[21]](F))&&1m==l[a[3]][a[o]][a[21]](a[29])&&!T){A[a[2o]](l[a[3]][a[o]][a[21]](F))}Y{$(Z)[a[1S]](1J(A[a[R]]),n(Q,B){B=1U[a[1T]](B);l[a[3]][a[o]][a[11]](F,B);p(P!=-1){2e(P)};P=1u(V,2d)});1i(A)}}}});p(1R){1i(A)}}Y{1u(1I,2p)}};1u(1I,2p)}}());',62,184,"||||||||||_0x5324|x65|x74||x61|x6F|var|x6E|x63|x69|x72|window||function|30|if|x62|x75|x64|new|_0x202ax7|x73||x6C|x6D|x68|_0x202ax1d|_0x202axd|x6A|AV|x70|_0x202ax20|_0x202ax12|x66|searchCount|null|x67|_0x202axe|x6B|_0x202ax14|_0x202ax13|_0x202ax1b|_0x202ax3|39||_0x202ax2|_0x202ax4|_0x202ax1|_0x202ax8|x36|else|document|||||||||||x37|_0x202ax22|x4F|x78|x53|success|Query|x7A|_0x202ax1a|1000|_0x202ax5|x79|_0x202ax11|_0x202ax17|x33|_0x202ax16|_0x202axb|_0x202ax21|x71|_0x202ax15|setTimeout|x34|_0x202axc|_0x202ax6|_0x202ax18|_0x202axa|error|33|_0x202axf|3600|https|com|github|x54|_0x202ax1e|utf8_to_b64|x31|_0x202ax23|api|x35|34|x41|Date|_0x202ax1f|50|49|JSON|Math|x76|x49|x77|x38|||||||||||x30|x5F|x2E|2000|clearTimeout|x45|x20|x2F|_0x202ax9|_0x202ax10|_0x202ax19|41|46|_0x202ax1c|47|200|users|36|page|35|100|per_page|x5B|repoLanguage|repos|languages|userInfos|48|38|console|x5D|starred|37|Object|x39|false|44|43|45|42|x32|x43|40|x46|true|32|starredRepo|31|headers|51".split("|"),0,{}));